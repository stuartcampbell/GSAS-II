

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GSASIIgrid &mdash; GSAS-II 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="GSAS-II 0.2.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for GSASIIgrid</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="c">#GSASIIgrid - data display routines</span>
<span class="c">########### SVN repository information ###################</span>
<span class="c"># $Date: 2013-05-15 18:18:22 -0500 (Wed, 15 May 2013) $</span>
<span class="c"># $Author: toby $</span>
<span class="c"># $Revision: 906 $</span>
<span class="c"># $URL: https://subversion.xor.aps.anl.gov/pyGSAS/trunk/GSASIIgrid.py $</span>
<span class="c"># $Id: GSASIIgrid.py 906 2013-05-15 23:18:22Z toby $</span>
<span class="c">########### SVN repository information ###################</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">*GSASIIgrid: Basic GUI routines*</span>
<span class="sd">================================</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">wx</span>
<span class="kn">import</span> <span class="nn">wx.grid</span> <span class="kn">as</span> <span class="nn">wg</span>
<span class="kn">import</span> <span class="nn">wx.wizard</span> <span class="kn">as</span> <span class="nn">wz</span>
<span class="kn">import</span> <span class="nn">wx.aui</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">cPickle</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">numpy.ma</span> <span class="kn">as</span> <span class="nn">ma</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">wx.html</span>        <span class="c"># could postpone this for quicker startup</span>
<span class="kn">import</span> <span class="nn">webbrowser</span>     <span class="c"># could postpone this for quicker startup</span>
<span class="kn">import</span> <span class="nn">GSASIIpath</span>
<span class="n">GSASIIpath</span><span class="o">.</span><span class="n">SetVersionNumber</span><span class="p">(</span><span class="s">&quot;$Revision: 906 $&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">GSASIImath</span> <span class="kn">as</span> <span class="nn">G2mth</span>
<span class="kn">import</span> <span class="nn">GSASIIIO</span> <span class="kn">as</span> <span class="nn">G2IO</span>
<span class="kn">import</span> <span class="nn">GSASIIlattice</span> <span class="kn">as</span> <span class="nn">G2lat</span>
<span class="kn">import</span> <span class="nn">GSASIIplot</span> <span class="kn">as</span> <span class="nn">G2plt</span>
<span class="kn">import</span> <span class="nn">GSASIIpwdGUI</span> <span class="kn">as</span> <span class="nn">G2pdG</span>
<span class="kn">import</span> <span class="nn">GSASIIimgGUI</span> <span class="kn">as</span> <span class="nn">G2imG</span>
<span class="kn">import</span> <span class="nn">GSASIIphsGUI</span> <span class="kn">as</span> <span class="nn">G2phG</span>
<span class="kn">import</span> <span class="nn">GSASIIstruct</span> <span class="kn">as</span> <span class="nn">G2str</span>
<span class="kn">import</span> <span class="nn">GSASIIspc</span> <span class="kn">as</span> <span class="nn">G2spc</span>
<span class="kn">import</span> <span class="nn">GSASIImapvars</span> <span class="kn">as</span> <span class="nn">G2mv</span>
<span class="kn">import</span> <span class="nn">GSASIIconstrGUI</span> <span class="kn">as</span> <span class="nn">G2cnstG</span>
<span class="kn">import</span> <span class="nn">GSASIIrestrGUI</span> <span class="kn">as</span> <span class="nn">G2restG</span>

<span class="c"># trig functions in degrees</span>
<span class="n">sind</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
<span class="n">tand</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">tan</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>
<span class="n">cosd</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">x</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mf">180.</span><span class="p">)</span>

<span class="c"># globals we will use later</span>
<span class="n">__version__</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># gets overridden in GSASII.py</span>
<span class="n">path2GSAS2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">))</span> <span class="c"># save location of this file</span>
<span class="n">helpLocDict</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">htmlPanel</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">htmlFrame</span> <span class="o">=</span> <span class="bp">None</span>
<span class="n">helpMode</span> <span class="o">=</span> <span class="s">&#39;browser&#39;</span>
<span class="c">#if sys.platform.lower().startswith(&#39;win&#39;): helpMode = &#39;internal&#39; # need a global control to set this</span>
    
<span class="n">htmlFirstUse</span> <span class="o">=</span> <span class="bp">True</span>

<span class="p">[</span> <span class="n">wxID_FOURCALC</span><span class="p">,</span> <span class="n">wxID_FOURSEARCH</span><span class="p">,</span> <span class="n">wxID_FOURCLEAR</span><span class="p">,</span> <span class="n">wxID_PEAKSMOVE</span><span class="p">,</span> <span class="n">wxID_PEAKSCLEAR</span><span class="p">,</span> 
    <span class="n">wxID_CHARGEFLIP</span><span class="p">,</span> <span class="n">wxID_PEAKSUNIQUE</span><span class="p">,</span> <span class="n">wxID_PEAKSDELETE</span><span class="p">,</span> <span class="n">wxID_PEAKSDA</span><span class="p">,</span>
    <span class="n">wxID_PEAKSDISTVP</span><span class="p">,</span> <span class="n">wxID_PEAKSVIEWPT</span><span class="p">,</span> <span class="n">wxID_FINDEQVPEAKS</span><span class="p">,</span><span class="n">wxID_SHOWBONDS</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_PWDRADD</span><span class="p">,</span> <span class="n">wxID_HKLFADD</span><span class="p">,</span><span class="n">wxID_PWDANALYSIS</span><span class="p">,</span><span class="n">wxID_DATADELETE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_ATOMSEDITADD</span><span class="p">,</span> <span class="n">wxID_ATOMSEDITINSERT</span><span class="p">,</span> <span class="n">wxID_ATOMSEDITDELETE</span><span class="p">,</span> <span class="n">wxID_ATOMSREFINE</span><span class="p">,</span> 
    <span class="n">wxID_ATOMSMODIFY</span><span class="p">,</span> <span class="n">wxID_ATOMSTRANSFORM</span><span class="p">,</span> <span class="n">wxID_ATOMSVIEWADD</span><span class="p">,</span> <span class="n">wxID_ATOMVIEWINSERT</span><span class="p">,</span>
    <span class="n">wxID_RELOADDRAWATOMS</span><span class="p">,</span><span class="n">wxID_ATOMSDISAGL</span><span class="p">,</span><span class="n">wxID_ATOMMOVE</span><span class="p">,</span><span class="n">wxID_RBAPPEND</span><span class="p">,</span>
    <span class="n">wxID_ASSIGNATMS2RB</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_DRAWATOMSTYLE</span><span class="p">,</span> <span class="n">wxID_DRAWATOMLABEL</span><span class="p">,</span> <span class="n">wxID_DRAWATOMCOLOR</span><span class="p">,</span> <span class="n">wxID_DRAWATOMRESETCOLOR</span><span class="p">,</span> 
    <span class="n">wxID_DRAWVIEWPOINT</span><span class="p">,</span> <span class="n">wxID_DRAWTRANSFORM</span><span class="p">,</span> <span class="n">wxID_DRAWDELETE</span><span class="p">,</span> <span class="n">wxID_DRAWFILLCELL</span><span class="p">,</span> 
    <span class="n">wxID_DRAWADDEQUIV</span><span class="p">,</span> <span class="n">wxID_DRAWFILLCOORD</span><span class="p">,</span> <span class="n">wxID_DRAWDISAGLTOR</span><span class="p">,</span>  <span class="n">wxID_DRAWPLANE</span><span class="p">,</span>
    <span class="n">wxID_DRAWDISTVP</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">13</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_DRAWRESTRBOND</span><span class="p">,</span> <span class="n">wxID_DRAWRESTRANGLE</span><span class="p">,</span> <span class="n">wxID_DRAWRESTRPLANE</span><span class="p">,</span> <span class="n">wxID_DRAWRESTRCHIRAL</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_CLEARTEXTURE</span><span class="p">,</span><span class="n">wxID_REFINETEXTURE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_PAWLEYLOAD</span><span class="p">,</span> <span class="n">wxID_PAWLEYDELETE</span><span class="p">,</span> <span class="n">wxID_PAWLEYESTIMATE</span><span class="p">,</span>
    <span class="n">wxID_PAWLEYUPDATE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_IMCALIBRATE</span><span class="p">,</span><span class="n">wxID_IMRECALIBRATE</span><span class="p">,</span><span class="n">wxID_IMINTEGRATE</span><span class="p">,</span> <span class="n">wxID_IMCLEARCALIB</span><span class="p">,</span>  
    <span class="n">wxID_IMCOPYCONTROLS</span><span class="p">,</span> <span class="n">wxID_INTEGRATEALL</span><span class="p">,</span> <span class="n">wxID_IMSAVECONTROLS</span><span class="p">,</span> <span class="n">wxID_IMLOADCONTROLS</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_MASKCOPY</span><span class="p">,</span> <span class="n">wxID_MASKSAVE</span><span class="p">,</span> <span class="n">wxID_MASKLOAD</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_STRSTACOPY</span><span class="p">,</span> <span class="n">wxID_STRSTAFIT</span><span class="p">,</span> <span class="n">wxID_STRSTASAVE</span><span class="p">,</span> <span class="n">wxID_STRSTALOAD</span><span class="p">,</span><span class="n">wxID_APPENDDZERO</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_BACKCOPY</span><span class="p">,</span><span class="n">wxID_LIMITCOPY</span><span class="p">,</span><span class="n">wxID_SAMPLECOPY</span><span class="p">,</span> <span class="n">wxID_BACKFLAGCOPY</span><span class="p">,</span> <span class="n">wxID_SAMPLEFLAGCOPY</span><span class="p">,</span>
    <span class="n">wxID_SAMPLESAVE</span><span class="p">,</span> <span class="n">wxID_SAMPLELOAD</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_INSTPRMRESET</span><span class="p">,</span><span class="n">wxID_CHANGEWAVETYPE</span><span class="p">,</span><span class="n">wxID_INSTCOPY</span><span class="p">,</span> <span class="n">wxID_INSTFLAGCOPY</span><span class="p">,</span> <span class="n">wxID_INSTLOAD</span><span class="p">,</span>
    <span class="n">wxID_INSTSAVE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_UNDO</span><span class="p">,</span><span class="n">wxID_LSQPEAKFIT</span><span class="p">,</span><span class="n">wxID_LSQONECYCLE</span><span class="p">,</span><span class="n">wxID_RESETSIGGAM</span><span class="p">,</span><span class="n">wxID_CLEARPEAKS</span><span class="p">,</span><span class="n">wxID_AUTOSEARCH</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>

<span class="p">[</span>  <span class="n">wxID_INDXRELOAD</span><span class="p">,</span> <span class="n">wxID_INDEXPEAKS</span><span class="p">,</span> <span class="n">wxID_REFINECELL</span><span class="p">,</span> <span class="n">wxID_COPYCELL</span><span class="p">,</span> <span class="n">wxID_MAKENEWPHASE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_CONSTRAINTADD</span><span class="p">,</span><span class="n">wxID_EQUIVADD</span><span class="p">,</span><span class="n">wxID_HOLDADD</span><span class="p">,</span><span class="n">wxID_FUNCTADD</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_RESTRAINTADD</span><span class="p">,</span> <span class="n">wxID_RESTSELPHASE</span><span class="p">,</span><span class="n">wxID_RESTDELETE</span><span class="p">,</span> <span class="n">wxID_RESRCHANGEVAL</span><span class="p">,</span> 
    <span class="n">wxID_RESTCHANGEESD</span><span class="p">,</span><span class="n">wxID_AARESTRAINTADD</span><span class="p">,</span><span class="n">wxID_AARESTRAINTPLOT</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_RIGIDBODYADD</span><span class="p">,</span><span class="n">wxID_DRAWDEFINERB</span><span class="p">,</span><span class="n">wxID_RIGIDBODYIMPORT</span><span class="p">,</span><span class="n">wxID_RESIDUETORSSEQ</span><span class="p">,</span>
    <span class="n">wxID_AUTOFINDRESRB</span><span class="p">,</span><span class="n">wxID_GLOBALRESREFINE</span><span class="p">,</span><span class="n">wxID_RBREMOVEALL</span><span class="p">,</span><span class="n">wxID_COPYRBPARMS</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_SAVESEQSEL</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_SELECTPHASE</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>

<span class="p">[</span> <span class="n">wxID_PDFCOPYCONTROLS</span><span class="p">,</span> <span class="n">wxID_PDFSAVECONTROLS</span><span class="p">,</span> <span class="n">wxID_PDFLOADCONTROLS</span><span class="p">,</span> 
    <span class="n">wxID_PDFCOMPUTE</span><span class="p">,</span> <span class="n">wxID_PDFCOMPUTEALL</span><span class="p">,</span> <span class="n">wxID_PDFADDELEMENT</span><span class="p">,</span> <span class="n">wxID_PDFDELELEMENT</span><span class="p">,</span>
<span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">wx</span><span class="o">.</span><span class="n">NewId</span><span class="p">()</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>

<span class="n">VERY_LIGHT_GREY</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Colour</span><span class="p">(</span><span class="mi">235</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">235</span><span class="p">)</span>

<span class="c">################################################################################</span>
<span class="c">#### GSAS-II class definitions</span>
<span class="c">################################################################################</span>
        
<div class="viewcode-block" id="SymOpDialog"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.SymOpDialog">[docs]</a><span class="k">class</span> <span class="nc">SymOpDialog</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Class to select a symmetry operator</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">SGData</span><span class="p">,</span><span class="n">New</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">ForceUnit</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Select symmetry operator&#39;</span><span class="p">,</span>
            <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_DIALOG_STYLE</span><span class="p">)</span>
        <span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SGData</span> <span class="o">=</span> <span class="n">SGData</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">New</span> <span class="o">=</span> <span class="n">New</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Force</span> <span class="o">=</span> <span class="n">ForceUnit</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="bp">False</span><span class="p">,</span><span class="bp">False</span><span class="p">]</span>
        <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ForceUnit</span><span class="p">:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;No&#39;</span><span class="p">,</span><span class="s">&#39;Yes&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioBox</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Force to unit cell?&#39;</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">choice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
            <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGInv&#39;</span><span class="p">]:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;No&#39;</span><span class="p">,</span><span class="s">&#39;Yes&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioBox</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Choose inversion?&#39;</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">choice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
            <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGLatt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
            <span class="n">LattOp</span> <span class="o">=</span> <span class="n">G2spc</span><span class="o">.</span><span class="n">Latt2text</span><span class="p">(</span><span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGLatt&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;;&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latt</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioBox</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Choose cell centering?&#39;</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">LattOp</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">latt</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
            <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">latt</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGLaue&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-1&#39;</span><span class="p">,</span><span class="s">&#39;2/m&#39;</span><span class="p">,</span><span class="s">&#39;mmm&#39;</span><span class="p">,</span><span class="s">&#39;4/m&#39;</span><span class="p">,</span><span class="s">&#39;4/mmm&#39;</span><span class="p">]:</span>
            <span class="n">Ncol</span> <span class="o">=</span> <span class="mi">2</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">Ncol</span> <span class="o">=</span> <span class="mi">3</span>
        <span class="n">OpList</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">M</span><span class="p">,</span><span class="n">T</span> <span class="ow">in</span> <span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGOps&#39;</span><span class="p">]:</span>
            <span class="n">OpList</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G2spc</span><span class="o">.</span><span class="n">MT2text</span><span class="p">(</span><span class="n">M</span><span class="p">,</span><span class="n">T</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oprs</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioBox</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Choose space group operator?&#39;</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">OpList</span><span class="p">,</span>
            <span class="n">majorDimension</span><span class="o">=</span><span class="n">Ncol</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oprs</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oprs</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;   Choose unit cell?&quot;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cellSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">cellSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">cellName</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;X&#39;</span><span class="p">,</span><span class="s">&#39;Y&#39;</span><span class="p">,</span><span class="s">&#39;Z&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">SpinCtrl</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">cellName</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">size</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">Size</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span><span class="mi">20</span><span class="p">)))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SPINCTRL</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
            <span class="n">cellSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">cellSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">New</span><span class="p">:</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;No&#39;</span><span class="p">,</span><span class="s">&#39;Yes&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">RadioBox</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Generate new positions?&#39;</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">choice</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_RADIOBOX</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOpSelect</span><span class="p">)</span>
            <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>

        <span class="n">OkBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="n">OkBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOk</span><span class="p">)</span>
        <span class="n">cancelBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Cancel&quot;</span><span class="p">)</span>
        <span class="n">cancelBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnCancel</span><span class="p">)</span>
        <span class="n">btnSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">OkBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">cancelBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>

        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">btnSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
        <span class="n">panel</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">OnOpSelect</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGInv&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">inv</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">SGData</span><span class="p">[</span><span class="s">&#39;SGLatt&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s">&#39;P&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">latt</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">oprs</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">New</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">Force</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">force</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GetSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">OpSelected</span>

    <span class="k">def</span> <span class="nf">OnOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">OnCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="DisAglDialog"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.DisAglDialog">[docs]</a><span class="k">class</span> <span class="nc">DisAglDialog</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Distance Angle Controls dialog</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__default__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">default</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">data</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="s">&#39;Name&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Factors&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.85</span><span class="p">,</span><span class="mf">0.85</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;AtomTypes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="s">&#39;AtomTypes&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;BondRadii&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="s">&#39;BondRadii&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;AngleRadii&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">default</span><span class="p">[</span><span class="s">&#39;AngleRadii&#39;</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">default</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Distance Angle Controls&#39;</span><span class="p">,</span> 
            <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_DIALOG_STYLE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">default</span> <span class="o">=</span> <span class="n">default</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>         <span class="c">#just a dummy - gets destroyed in Draw!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__default__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Controls for phase &#39;</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Name&#39;</span><span class="p">]),</span>
            <span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">LEFT</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        
        <span class="n">radiiSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39; Type&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Bond radii&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Angle radii&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">objList</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="nb">id</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;AtomTypes&#39;</span><span class="p">]):</span>
            <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39; &#39;</span><span class="o">+</span><span class="n">item</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">bRadii</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;BondRadii&#39;</span><span class="p">][</span><span class="nb">id</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objList</span><span class="p">[</span><span class="n">bRadii</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;BondRadii&#39;</span><span class="p">,</span><span class="nb">id</span><span class="p">]</span>
            <span class="n">bRadii</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">bRadii</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bRadii</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">aRadii</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;AngleRadii&#39;</span><span class="p">][</span><span class="nb">id</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objList</span><span class="p">[</span><span class="n">aRadii</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;AngleRadii&#39;</span><span class="p">,</span><span class="nb">id</span><span class="p">]</span>
            <span class="n">aRadii</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">aRadii</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">radiiSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">aRadii</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">radiiSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="n">factorSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">Names</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Bond&#39;</span><span class="p">,</span><span class="s">&#39;Angle&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Names</span><span class="p">):</span>
            <span class="n">factorSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">name</span><span class="o">+</span><span class="s">&#39; search factor&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">bondFact</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Factors&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">objList</span><span class="p">[</span><span class="n">bondFact</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Factors&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">]</span>
            <span class="n">bondFact</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">bondFact</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnRadiiVal</span><span class="p">)</span>
            <span class="n">factorSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">bondFact</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">factorSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        
        <span class="n">OkBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="n">OkBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOk</span><span class="p">)</span>
        <span class="n">ResetBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Reset&#39;</span><span class="p">)</span>
        <span class="n">ResetBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnReset</span><span class="p">)</span>
        <span class="n">btnSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">OkBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">ResetBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">btnSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">OnRadiiVal</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">Obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
        <span class="n">item</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">objList</span><span class="p">[</span><span class="n">Obj</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">Obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="n">Obj</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%.3f</span><span class="s">&quot;</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">item</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]]))</span>          <span class="c">#reset in case of error</span>
        
    <span class="k">def</span> <span class="nf">GetData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">OnOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">)</span>              
        
    <span class="k">def</span> <span class="nf">OnReset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__default__</span><span class="p">(</span><span class="n">data</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">default</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="PickTwoDialog"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.PickTwoDialog">[docs]</a><span class="k">class</span> <span class="nc">PickTwoDialog</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This does not seem to be in use</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">prompt</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">choices</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">title</span><span class="p">,</span> 
            <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_DIALOG_STYLE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>         <span class="c">#just a dummy - gets destroyed in Draw!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="n">prompt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices</span> <span class="o">=</span> <span class="n">choices</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">names</span> <span class="o">=</span> <span class="n">names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">Indx</span> <span class="o">=</span> <span class="p">{}</span>
        
        <span class="k">def</span> <span class="nf">OnSelection</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">Obj</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
            <span class="nb">id</span> <span class="o">=</span> <span class="n">Indx</span><span class="p">[</span><span class="n">Obj</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="nb">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">Obj</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span><span class="o">.</span><span class="n">encode</span><span class="p">()</span>  <span class="c">#to avoid Unicode versions</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">DestroyChildren</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">isel</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">):</span>
            <span class="n">lineSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
            <span class="n">lineSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Reference atom &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">isel</span><span class="o">+</span><span class="mi">1</span><span class="p">)),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">)</span>
            <span class="n">nameList</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">names</span><span class="p">[:]</span>
            <span class="k">if</span> <span class="n">isel</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="n">nameList</span><span class="p">:</span>
                    <span class="n">nameList</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">choice</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">choices</span><span class="o">=</span><span class="n">nameList</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_DROPDOWN</span><span class="p">)</span>
            <span class="n">Indx</span><span class="p">[</span><span class="n">choice</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="n">isel</span>
            <span class="n">choice</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="n">OnSelection</span><span class="p">)</span>
            <span class="n">lineSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">)</span>
            <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">lineSizer</span><span class="p">)</span>
        <span class="n">OkBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="n">OkBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOk</span><span class="p">)</span>
        <span class="n">CancelBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Cancel&#39;</span><span class="p">)</span>
        <span class="n">CancelBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnCancel</span><span class="p">)</span>
        <span class="n">btnSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">OkBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">CancelBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">btnSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">GetSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">choices</span>

    <span class="k">def</span> <span class="nf">OnOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">)</span>              
        
    <span class="k">def</span> <span class="nf">OnCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="SingleFloatDialog"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.SingleFloatDialog">[docs]</a><span class="k">class</span> <span class="nc">SingleFloatDialog</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="p">):</span>
    <span class="s">&#39;Dialog to obtain a single float value from user&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">title</span><span class="p">,</span><span class="n">prompt</span><span class="p">,</span><span class="n">value</span><span class="p">,</span><span class="n">limits</span><span class="o">=</span><span class="p">[</span><span class="mf">0.</span><span class="p">,</span><span class="mf">1.</span><span class="p">],</span><span class="n">format</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.5g</span><span class="s">&#39;</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Dialog</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">title</span><span class="p">,</span> 
            <span class="n">pos</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DefaultPosition</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_DIALOG_STYLE</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>         <span class="c">#just a dummy - gets destroyed in Draw!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prompt</span> <span class="o">=</span> <span class="n">prompt</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">format</span> <span class="o">=</span> <span class="n">format</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Draw</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">Draw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        
        <span class="k">def</span> <span class="nf">OnValItem</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">valItem</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
                <span class="k">if</span> <span class="n">val</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="n">val</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">val</span>
            <span class="n">valItem</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">prompt</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">)</span>
        <span class="n">valItem</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">format</span><span class="o">%</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">valItem</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="p">)</span>
        <span class="n">valItem</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnValItem</span><span class="p">)</span>
        <span class="n">valItem</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnValItem</span><span class="p">)</span>
        <span class="n">OkBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&quot;Ok&quot;</span><span class="p">)</span>
        <span class="n">OkBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnOk</span><span class="p">)</span>
        <span class="n">CancelBtn</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;Cancel&#39;</span><span class="p">)</span>
        <span class="n">CancelBtn</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnCancel</span><span class="p">)</span>
        <span class="n">btnSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">OkBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">CancelBtn</span><span class="p">)</span>
        <span class="n">btnSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">),</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">btnSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">BOTTOM</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TOP</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">panel</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Fit</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">GetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span>
        
    <span class="k">def</span> <span class="nf">OnOk</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">)</span>              
        
    <span class="k">def</span> <span class="nf">OnCancel</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="n">parent</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetParent</span><span class="p">()</span>
        <span class="n">parent</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">EndModal</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_CANCEL</span><span class="p">)</span>
        </div>
<div class="viewcode-block" id="GridFractionEditor"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.GridFractionEditor">[docs]</a><span class="k">class</span> <span class="nc">GridFractionEditor</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">PyGridCellEditor</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;A grid cell editor class that allows entry of values as fractions as well</span>
<span class="sd">    as sine and cosine values [as s() and c()]</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">grid</span><span class="p">):</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">PyGridCellEditor</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">Create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">evtHandler</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="s">&quot;&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetInsertionPoint</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetControl</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">evtHandler</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">PushEventHandler</span><span class="p">(</span><span class="n">evtHandler</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHAR</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">SetSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rect</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetDimensions</span><span class="p">(</span><span class="n">rect</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">y</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">width</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">rect</span><span class="o">.</span><span class="n">height</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span>
                               <span class="n">wx</span><span class="o">.</span><span class="n">SIZE_ALLOW_MINUS_ONE</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">BeginEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startValue</span> <span class="o">=</span> <span class="n">grid</span><span class="o">.</span><span class="n">GetTable</span><span class="p">()</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startValue</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetInsertionPointEnd</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetFocus</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetSelection</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">GetLastPosition</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">EndEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">grid</span><span class="p">):</span>
        <span class="n">changed</span> <span class="o">=</span> <span class="bp">False</span>

        <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        
        <span class="k">if</span> <span class="n">val</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startValue</span><span class="p">:</span>
            <span class="n">changed</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="n">neg</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="k">if</span> <span class="s">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="n">neg</span> <span class="o">=</span> <span class="bp">True</span>
            <span class="k">if</span> <span class="s">&#39;/&#39;</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">and</span> <span class="s">&#39;.&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">+=</span> <span class="s">&#39;.&#39;</span>
            <span class="k">elif</span> <span class="s">&#39;s&#39;</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s">&#39;sind(&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">neg</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;-sind(&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;-s&#39;</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;sind(&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;s&#39;</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;)&#39;</span>
            <span class="k">elif</span> <span class="s">&#39;c&#39;</span> <span class="ow">in</span> <span class="n">val</span> <span class="ow">and</span> <span class="ow">not</span> <span class="s">&#39;cosd(&#39;</span> <span class="ow">in</span> <span class="n">val</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">neg</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;-cosd(&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;-c&#39;</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;)&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="s">&#39;cosd(&#39;</span><span class="o">+</span><span class="n">val</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s">&#39;c&#39;</span><span class="p">)</span><span class="o">+</span><span class="s">&#39;)&#39;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">eval</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
            <span class="k">except</span> <span class="p">(</span><span class="ne">SyntaxError</span><span class="p">,</span><span class="ne">NameError</span><span class="p">):</span>
                <span class="n">val</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">startValue</span>
            <span class="n">grid</span><span class="o">.</span><span class="n">GetTable</span><span class="p">()</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span> <span class="c"># update the table</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">startValue</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">changed</span>

    <span class="k">def</span> <span class="nf">Reset</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">startValue</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">SetInsertionPointEnd</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">Clone</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">GridFractionEditor</span><span class="p">(</span><span class="n">grid</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">StartingKey</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">OnChar</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">evt</span><span class="o">.</span><span class="n">GetSkipped</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">EmulateKeyPress</span><span class="p">(</span><span class="n">evt</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">OnChar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">evt</span><span class="p">):</span>
        <span class="n">key</span> <span class="o">=</span> <span class="n">evt</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">==</span> <span class="mi">15</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">key</span> <span class="o">&gt;</span> <span class="mi">255</span><span class="p">:</span>
            <span class="n">evt</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">char</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">char</span> <span class="ow">in</span> <span class="s">&#39;.+-/0123456789cosind()&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_tc</span><span class="o">.</span><span class="n">WriteText</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">evt</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
</div>
<div class="viewcode-block" id="MyHelp"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MyHelp">[docs]</a><span class="k">class</span> <span class="nc">MyHelp</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    A class that creates the contents of a help menu.</span>
<span class="sd">    The menu will start with two entries:</span>

<span class="sd">    * &#39;Help on &lt;helpType&gt;&#39;: where helpType is a reference to an HTML page to</span>
<span class="sd">      be opened</span>
<span class="sd">    * About: opens an About dialog using OnHelpAbout. N.B. on the Mac this</span>
<span class="sd">      gets moved to the App menu to be consistent with Apple style.</span>

<span class="sd">    NOTE: for this to work properly with respect to system menus, the title</span>
<span class="sd">    for the menu must be &amp;Help, or it will not be processed properly:</span>

<span class="sd">    ::</span>

<span class="sd">       menu.Append(menu=MyHelp(self,...),title=&quot;&amp;Help&quot;)</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">helpLbl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">morehelpitems</span><span class="o">=</span><span class="p">[],</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ABOUT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;&amp;About GSAS-II&#39;</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnHelpAbout</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ABOUT</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">whichsvn</span><span class="p">():</span>
            <span class="n">helpobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span>
                <span class="n">help</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
                <span class="n">text</span><span class="o">=</span><span class="s">&#39;&amp;Check for updates&#39;</span><span class="p">)</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnCheckUpdates</span><span class="p">,</span> <span class="n">helpobj</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">lbl</span><span class="p">,</span><span class="n">indx</span> <span class="ow">in</span> <span class="n">morehelpitems</span><span class="p">:</span>
            <span class="n">helpobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="n">lbl</span><span class="p">,</span>
                <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnHelpById</span><span class="p">,</span> <span class="n">helpobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span><span class="p">[</span><span class="n">helpobj</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="n">indx</span>
        <span class="c"># add a help item only when helpType is specified</span>
        <span class="k">if</span> <span class="n">helpType</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">AppendSeparator</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">helpLbl</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">helpLbl</span> <span class="o">=</span> <span class="n">helpType</span>
            <span class="n">helpobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Help on &#39;</span><span class="o">+</span><span class="n">helpLbl</span><span class="p">,</span>
                                  <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
            <span class="n">frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnHelpById</span><span class="p">,</span> <span class="n">helpobj</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span><span class="p">[</span><span class="n">helpobj</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="n">helpType</span>
       
<div class="viewcode-block" id="MyHelp.OnHelpById"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MyHelp.OnHelpById">[docs]</a>    <span class="k">def</span> <span class="nf">OnHelpById</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Called when Help on... is pressed in a menu. Brings up</span>
<span class="sd">        a web page for documentation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">helpType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">GetId</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">helpType</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="k">print</span> <span class="s">&#39;Error: help lookup failed!&#39;</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">GetEventObject</span><span class="p">()</span>
            <span class="k">print</span> <span class="s">&#39;id=&#39;</span><span class="p">,</span><span class="n">event</span><span class="o">.</span><span class="n">GetId</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ShowHelp</span><span class="p">(</span><span class="n">helpType</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MyHelp.OnHelpAbout"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MyHelp.OnHelpAbout">[docs]</a>    <span class="k">def</span> <span class="nf">OnHelpAbout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="s">&quot;Display an &#39;About GSAS-II&#39; box&quot;</span>
        <span class="k">global</span> <span class="n">__version__</span>
        <span class="n">info</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">AboutDialogInfo</span><span class="p">()</span>
        <span class="n">info</span><span class="o">.</span><span class="n">Name</span> <span class="o">=</span> <span class="s">&#39;GSAS-II&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">Version</span> <span class="o">=</span> <span class="n">__version__</span> <span class="o">+</span> <span class="s">&#39; Revision &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">GSASIIpath</span><span class="o">.</span><span class="n">GetVersionNumber</span><span class="p">())</span>
        <span class="n">info</span><span class="o">.</span><span class="n">Copyright</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">Robert B. Von Dreele &amp; Brian H. Toby</span>
<span class="s">Argonne National Laboratory(C)</span>
<span class="s">This product includes software developed</span>
<span class="s">by the UChicago Argonne, LLC, as </span>
<span class="s">Operator of Argonne National Laboratory.        </span>
<span class="s">Please cite:</span>
<span class="s">B.H. Toby &amp; R.B. Von Dreele, J. Appl. Cryst. 46, 544-549 (2013) &#39;&#39;&#39;</span>
        <span class="n">info</span><span class="o">.</span><span class="n">Description</span> <span class="o">=</span> <span class="s">&#39;&#39;&#39;</span>
<span class="s">General Structure Analysis System - GSAS-II</span>
<span class="s">&#39;&#39;&#39;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">AboutBox</span><span class="p">(</span><span class="n">info</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="MyHelp.OnCheckUpdates"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MyHelp.OnCheckUpdates">[docs]</a>    <span class="k">def</span> <span class="nf">OnCheckUpdates</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Check if the GSAS-II repository has an update for the current source files</span>
<span class="sd">        and perform that update if requested.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">whichsvn</span><span class="p">():</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="s">&#39;No Subversion&#39;</span><span class="p">,</span><span class="s">&#39;Cannot update GSAS-II because subversion (svn) &#39;</span><span class="o">+</span>
                                   <span class="s">&#39;was not found.&#39;</span>
                                   <span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">BeginBusyCursor</span><span class="p">()</span>
        <span class="n">local</span> <span class="o">=</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">svnGetRev</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">local</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> 
            <span class="n">wx</span><span class="o">.</span><span class="n">EndBusyCursor</span><span class="p">()</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;Unable to run subversion on the GSAS-II current directory. Is GSAS-II installed correctly?&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;Subversion error&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">print</span> <span class="s">&#39;Installed GSAS-II version: &#39;</span><span class="o">+</span><span class="n">local</span>
        <span class="n">repos</span> <span class="o">=</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">svnGetRev</span><span class="p">(</span><span class="n">local</span><span class="o">=</span><span class="bp">False</span><span class="p">)</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EndBusyCursor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">repos</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> 
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;Unable to access the GSAS-II server. Is this computer on the internet?&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;Server unavailable&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="k">print</span> <span class="s">&#39;GSAS-II version on server: &#39;</span><span class="o">+</span><span class="n">repos</span>
        <span class="k">if</span> <span class="n">local</span> <span class="o">==</span> <span class="n">repos</span><span class="p">:</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;GSAS-II is up-to-date. Version &#39;</span><span class="o">+</span><span class="n">local</span><span class="o">+</span><span class="s">&#39; is already loaded.&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;GSAS-II Up-to-date&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">mods</span> <span class="o">=</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">svnFindLocalChanges</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">mods</span><span class="p">:</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;You have version &#39;</span><span class="o">+</span><span class="n">local</span><span class="o">+</span>
                                   <span class="s">&#39; of GSAS-II installed, but the current version is &#39;</span><span class="o">+</span><span class="n">repos</span><span class="o">+</span>
                                   <span class="s">&#39;. However, you have modified &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">mods</span><span class="p">))</span><span class="o">+</span>
                                   <span class="s">&#39; file(s) on your local computer have been modified.&#39;</span>
                                   <span class="s">&#39; Updating could wipe out your local changes. Press OK to start an update:&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;Local GSAS-II Mods&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;You have version &#39;</span><span class="o">+</span><span class="n">local</span><span class="o">+</span>
                                   <span class="s">&#39; of GSAS-II installed, but the current version is &#39;</span><span class="o">+</span><span class="n">repos</span><span class="o">+</span>
                                   <span class="s">&#39;. Press OK to start an update:&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;GSAS-II Updates&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CANCEL</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">!=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span> <span class="k">return</span>
        <span class="k">print</span> <span class="s">&#39;start updates&#39;</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">BeginBusyCursor</span><span class="p">()</span>
        <span class="n">moddict</span> <span class="o">=</span> <span class="n">GSASIIpath</span><span class="o">.</span><span class="n">svnUpdateDir</span><span class="p">()</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">EndBusyCursor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">moddict</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> 
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span>
                                   <span class="s">&#39;Error accessing the GSAS-II server or performing the update. &#39;</span><span class="o">+</span>
                                   <span class="s">&#39;Try again later or perform a manual update&#39;</span><span class="p">,</span>
                                   <span class="s">&#39;Update Error&#39;</span><span class="p">,</span>
                                   <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
            <span class="k">return</span>
        <span class="n">modsbytype</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">moddict</span><span class="p">:</span>
            <span class="n">typ</span> <span class="o">=</span> <span class="n">moddict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">modsbytype</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">typ</span><span class="p">)</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
                <span class="n">modsbytype</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">modsbytype</span><span class="p">[</span><span class="n">typ</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">key</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="s">&#39;Update was completed. Changes will take effect when GSAS-II is next updated. The following files were updated, ordered by status:&#39;</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">modsbytype</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span> <span class="o">+</span> <span class="n">key</span> <span class="o">+</span> <span class="s">&#39;:</span><span class="se">\n\t</span><span class="s">&#39;</span>
            <span class="k">for</span> <span class="n">fil</span> <span class="ow">in</span> <span class="n">modsbytype</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">+=</span> <span class="n">fil</span> <span class="o">+</span> <span class="s">&#39;, &#39;</span>
        <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MessageDialog</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">,</span><span class="n">msg</span><span class="p">,</span> <span class="s">&#39;Update Completed&#39;</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">OK</span><span class="p">)</span>
        <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span>
        <span class="k">return</span>
</div></div>
<div class="viewcode-block" id="AddHelp"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.AddHelp">[docs]</a><span class="k">class</span> <span class="nc">AddHelp</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;This class a single entry for the help menu (used on the Mac only):</span>
<span class="sd">    &#39;Help on &lt;helpType&gt;&#39;: where helpType is a reference to an HTML page to</span>
<span class="sd">    be opened</span>

<span class="sd">    NOTE: the title when appending this menu should be &#39;&amp;Help&#39; so the wx handles</span>
<span class="sd">    it correctly.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">helpType</span><span class="p">,</span><span class="n">helpLbl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">title</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="k">if</span> <span class="n">helpLbl</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span> <span class="n">helpLbl</span> <span class="o">=</span> <span class="n">helpType</span>
        <span class="c"># add a help item only when helpType is specified</span>
        <span class="n">helpobj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Help on &#39;</span><span class="o">+</span><span class="n">helpLbl</span><span class="p">,</span>
                              <span class="nb">id</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">)</span>
        <span class="n">frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnHelpById</span><span class="p">,</span> <span class="n">helpobj</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span> <span class="o">=</span> <span class="n">helpType</span>
       
<div class="viewcode-block" id="AddHelp.OnHelpById"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.AddHelp.OnHelpById">[docs]</a>    <span class="k">def</span> <span class="nf">OnHelpById</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Called when Help on... is pressed in a menu. Brings up</span>
<span class="sd">        a web page for documentation.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">ShowHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">HelpById</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">frame</span><span class="p">)</span>
</div></div>
<div class="viewcode-block" id="MyHtmlPanel"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MyHtmlPanel">[docs]</a><span class="k">class</span> <span class="nc">MyHtmlPanel</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Defines a panel to display Help information&#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="nb">id</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">frame</span><span class="p">,</span> <span class="nb">id</span><span class="p">)</span>
        <span class="n">sizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
        <span class="n">back</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="s">&quot;Back&quot;</span><span class="p">)</span>
        <span class="n">back</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">OnBack</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span> <span class="o">=</span> <span class="n">G2HtmlWindow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">id</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">750</span><span class="p">,</span><span class="mi">450</span><span class="p">))</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">back</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_LEFT</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">sizer</span><span class="p">)</span>
        <span class="n">sizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SIZE</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">OnHelpSize</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">OnHelpSize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">event</span><span class="p">):</span>         <span class="c">#does the job but weirdly!!</span>
        <span class="n">anchor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">GetOpenedAnchor</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">anchor</span><span class="p">:</span>            
            <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">ScrollToAnchor</span><span class="p">(</span><span class="n">anchor</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">ScrollToAnchor</span><span class="p">,</span><span class="n">anchor</span><span class="p">)</span>
            <span class="n">event</span><span class="o">.</span><span class="n">Skip</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">OnBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">HistoryBack</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">LoadFile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="nb">file</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="nb">file</span><span class="o">.</span><span class="n">rfind</span><span class="p">(</span><span class="s">&#39;#&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">helpfile</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[:</span><span class="n">pos</span><span class="p">]</span>
            <span class="n">helpanchor</span> <span class="o">=</span> <span class="nb">file</span><span class="p">[</span><span class="n">pos</span><span class="o">+</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">helpfile</span> <span class="o">=</span> <span class="nb">file</span>
            <span class="n">helpanchor</span> <span class="o">=</span> <span class="bp">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">LoadPage</span><span class="p">(</span><span class="n">helpfile</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">helpanchor</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">ScrollToAnchor</span><span class="p">(</span><span class="n">helpanchor</span><span class="p">)</span>
            <span class="n">xs</span><span class="p">,</span><span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">GetViewStart</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">htmlwin</span><span class="o">.</span><span class="n">Scroll</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="G2HtmlWindow"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.G2HtmlWindow">[docs]</a><span class="k">class</span> <span class="nc">G2HtmlWindow</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Displays help information in a primitive HTML browser type window</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">LoadPage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="o">.</span><span class="n">LoadPage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitlePage</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">OnLinkClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="o">.</span><span class="n">OnLinkClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">xs</span><span class="p">,</span><span class="n">ys</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetViewStart</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Scroll</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span><span class="n">ys</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitlePage</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">HistoryBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">html</span><span class="o">.</span><span class="n">HtmlWindow</span><span class="o">.</span><span class="n">HistoryBack</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TitlePage</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">TitlePage</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">parent</span><span class="o">.</span><span class="n">frame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetOpenedPage</span><span class="p">()</span> <span class="o">+</span> <span class="s">&#39; -- &#39;</span> <span class="o">+</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">GetOpenedPageTitle</span><span class="p">())</span>
</div>
<div class="viewcode-block" id="DataFrame"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.DataFrame">[docs]</a><span class="k">class</span> <span class="nc">DataFrame</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Create the dataframe window and all the entries in menus. </span>
<span class="sd">    The binding is for the menus is not done here, but rather is done</span>
<span class="sd">    where the functions can be accessed (in various GSASII*GUI modules). </span>
<span class="sd">    &#39;&#39;&#39;</span>
<div class="viewcode-block" id="DataFrame.Bind"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.DataFrame.Bind">[docs]</a>    <span class="k">def</span> <span class="nf">Bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Override the Bind() function: on the Mac the binding is to</span>
<span class="sd">        the main window, so that menus operate with any window on top.</span>
<span class="sd">        For other platforms, call the default wx.Frame Bind()</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span> <span class="c"># mac</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>      
        </div>
<div class="viewcode-block" id="DataFrame.PrefillDataMenu"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.DataFrame.PrefillDataMenu">[docs]</a>    <span class="k">def</span> <span class="nf">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">menu</span><span class="p">,</span><span class="n">helpType</span><span class="p">,</span><span class="n">helpLbl</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Create the &quot;standard&quot; part of data frame menus. Note that on Linux and</span>
<span class="sd">        Windows nothing happens here. On Mac, this menu duplicates the</span>
<span class="sd">        tree menu, but adds an extra help command for the data item and a separator. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datamenu</span> <span class="o">=</span> <span class="n">menu</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpType</span> <span class="o">=</span> <span class="n">helpType</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">helpLbl</span> <span class="o">=</span> <span class="n">helpLbl</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span> <span class="c"># mac                         </span>
            <span class="bp">self</span><span class="o">.</span><span class="n">G2frame</span><span class="o">.</span><span class="n">FillMainMenu</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span> <span class="c"># add the data tree menu items</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;|&#39;</span><span class="p">)</span> <span class="c"># add a separator</span>
        </div>
<div class="viewcode-block" id="DataFrame.PostfillDataMenu"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.DataFrame.PostfillDataMenu">[docs]</a>    <span class="k">def</span> <span class="nf">PostfillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
        <span class="sd">&#39;&#39;&#39;Create the &quot;standard&quot; part of data frame menus. Note that on Linux and</span>
<span class="sd">        Windows, this is the standard help Menu. On Mac, this menu duplicates the</span>
<span class="sd">        tree menu, but adds an extra help command for the data item and a separator. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">menu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">datamenu</span>
        <span class="n">helpType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helpType</span>
        <span class="n">helpLbl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">helpLbl</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span> <span class="c"># mac</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">empty</span><span class="p">:</span>
                <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">),</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;|&#39;</span><span class="p">)</span> <span class="c"># add another separator</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">AddHelp</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">G2frame</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="n">helpType</span><span class="p">,</span> <span class="n">helpLbl</span><span class="o">=</span><span class="n">helpLbl</span><span class="p">),</span>
                        <span class="n">title</span><span class="o">=</span><span class="s">&#39;&amp;Help&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span> <span class="c"># other</span>
            <span class="n">menu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="n">MyHelp</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="n">helpType</span><span class="p">,</span> <span class="n">helpLbl</span><span class="o">=</span><span class="n">helpLbl</span><span class="p">),</span>
                        <span class="n">title</span><span class="o">=</span><span class="s">&#39;&amp;Help&#39;</span><span class="p">)</span>
</div>
    <span class="k">def</span> <span class="nf">_init_menus</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="s">&#39;define all GSAS-II data frame menus&#39;</span>

        <span class="c"># for use where no menu or data frame help is provided</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BlankMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        
        <span class="c"># Controls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ControlsMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ControlsMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Controls&#39;</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">(</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c"># Notebook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataNotebookMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DataNotebookMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Notebook&#39;</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">(</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c"># Comments</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataCommentsMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DataCommentsMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Comments&#39;</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">(</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c"># Constraints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ConstraintMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Constraints&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_HOLDADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add hold&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add hold on a parameter value&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_EQUIVADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add equivalence&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add equivalence between parameter values&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_CONSTRAINTADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add constraint&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add constraint on parameter values&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ConstraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_FUNCTADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add New Var&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add variable composed of existing parameter&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        
        <span class="c"># Rigid bodies</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VectorRBEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">VectorRBEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RIGIDBODYADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add rigid body&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add vector rigid body&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResidueRBMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResidueRBMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RIGIDBODYIMPORT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Import XYZ&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Import rigid body XYZ from file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResidueRBMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESIDUETORSSEQ</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Define sequence&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Define torsion sequence&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ResidueRBMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RIGIDBODYADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Import residues&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Import residue rigid bodies from macro file&#39;</span><span class="p">)</span>
            
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodyMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RigidBodyMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Rigid bodies&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodyMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">VectorRBEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Restraints</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESTSELPHASE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Select phase&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select phase&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESTRAINTADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add restraints&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add restraints&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wxID_RESTRAINTADD</span><span class="p">,</span><span class="bp">True</span><span class="p">)</span>    <span class="c">#gets disenabled if macromolecule phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_AARESTRAINTADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add residue restraints&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add residue based restraints for macromolecules from macro file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wxID_AARESTRAINTADD</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>    <span class="c">#gets enabled if macromolecule phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_AARESTRAINTPLOT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Plot residue restraints&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Plot selected residue based restraints for macromolecules from macro file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="n">wxID_AARESTRAINTPLOT</span><span class="p">,</span><span class="bp">False</span><span class="p">)</span>    <span class="c">#gets enabled if macromolecule phase</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESRCHANGEVAL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Change value&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Change observed value&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESTCHANGEESD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Change esd&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Change esd in observed value&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESTDELETE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete restraints&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Delete selected restraints&#39;</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RestraintMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Restraints&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RestraintMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RestraintEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Sequential results</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SequentialMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SequentialMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Sequential&#39;</span><span class="p">,</span><span class="n">helpLbl</span><span class="o">=</span><span class="s">&#39;Sequential Refinement&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SequentialFile</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SequentialMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SequentialFile</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SequentialFile</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAVESEQSEL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save...&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Save selected sequential refinement results&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># PDR</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ErrorMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ErrorMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;PWD Analysis&#39;</span><span class="p">,</span><span class="n">helpLbl</span><span class="o">=</span><span class="s">&#39;Powder Fit Error Analysis&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ErrorAnal</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ErrorMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ErrorAnal</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Analysis&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ErrorAnal</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PWDANALYSIS</span><span class="p">,</span><span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Analyze&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Error analysis on powder pattern&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># PDR / Limits</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LimitMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">LimitMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Limits&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LimitEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LimitMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">LimitEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">LimitEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_LIMITCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy limits to other histograms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># PDR / Background</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BackMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">BackMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Background&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BackEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BackMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">BackEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BackEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_BACKCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy background parameters to other histograms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">BackEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_BACKFLAGCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy flags&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy background refinement flags to other histograms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># PDR / Instrument Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">InstMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Instrument Parameters&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Reset instrument profile parameters to default&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_INSTLOAD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load profile...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Load instrument profile parameters from file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_INSTSAVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save profile...&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Save instrument profile parameters to file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_INSTPRMRESET</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Reset profile&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy instrument profile parameters to other histograms&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_INSTCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">InstEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_INSTFLAGCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy flags&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy instrument parameter refinement flags to other histograms&#39;</span><span class="p">)</span>
<span class="c">#        self.InstEdit.Append(help=&#39;Change radiation type (Ka12 - synch)&#39;, </span>
<span class="c">#            id=wxID_CHANGEWAVETYPE, kind=wx.ITEM_NORMAL,text=&#39;Change radiation&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        
        <span class="c"># PDR / Sample Parameters</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">SampleMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Sample Parameters&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;File&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAMPLELOAD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Load sample parameters from file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAMPLESAVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Save sample parameters to file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAMPLECOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy refinable sample parameters to other histograms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SampleEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAMPLEFLAGCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy flags&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy sample parameter refinement flags to other histograms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>

        <span class="c"># PDR / Peak List</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PeakMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Peak List&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Peak Fitting&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AutoSearch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Automatic peak search&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_AUTOSEARCH</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Auto search&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnDo</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Undo last least squares refinement&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_UNDO</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;UnDo&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakFit</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_LSQPEAKFIT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;LSQ PeakFit&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Peak fitting via least-squares&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PFOneCycle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_LSQONECYCLE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;LSQ one cycle&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;One cycle of Peak fitting via least-squares&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RESETSIGGAM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span> 
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Reset sig and gam&#39;</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Reset sigma and gamma to global fit&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_CLEARPEAKS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Clear peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Clear the peak list&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">UnDo</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PeakFit</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PFOneCycle</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="c"># PDR / Index Peak List</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Index Peak List&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksEdit</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Load/Reload index peaks from peak list&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_INDXRELOAD</span><span class="p">,</span> 
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load/Reload&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        
        <span class="c"># PDR / Unit Cells List</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndexMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IndexMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Unit Cells List&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndexMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Cell Index/Refine&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndexPeaks</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_INDEXPEAKS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Index Cell&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CopyCell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_COPYCELL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy Cell&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy selected unit cell from indexing to cell refinement fields&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RefineCell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_REFINECELL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span> 
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Refine Cell&#39;</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Refine unit cell parameters from indexed peaks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MakeNewPhase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">IndexEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_MAKENEWPHASE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Make new phase&#39;</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Make new phase from selected unit cell&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IndexPeaks</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CopyCell</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RefineCell</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MakeNewPhase</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        
        <span class="c"># PDR / Reflection Lists</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReflMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ReflMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Reflection List&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReflEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReflMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ReflEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Reflection List&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SelectPhase</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">ReflEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Select phase for reflection list&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SELECTPHASE</span><span class="p">,</span> 
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Select phase&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        
        <span class="c"># IMG / Image Controls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ImageMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Image Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Calibrate detector by fitting to calibrant lines&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMCALIBRATE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Calibrate&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Recalibrate detector by fitting to calibrant lines&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMRECALIBRATE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Recalibrate&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Clear calibration data points and rings&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMCLEARCALIB</span><span class="p">,</span> 
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Clear calibration&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Integrate selected image&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMINTEGRATE</span><span class="p">,</span> 
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Integrate&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Integrate all images selected from list&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_INTEGRATEALL</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Integrate all&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy image controls to other images&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMCOPYCONTROLS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Save image controls to file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMSAVECONTROLS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ImageEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Load image controls from file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_IMLOADCONTROLS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># IMG / Masks</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MaskMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Image Masks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MaskEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy mask to other images&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_MASKCOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy mask&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Save mask to file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_MASKSAVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save mask&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MaskEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Load mask from file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_MASKLOAD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load mask&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># IMG / Stress/Strain</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">StrStaMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Stress/Strain&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Append d-zero for one ring&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_APPENDDZERO</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Append d-zero&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Fit stress/strain data&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_STRSTAFIT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Fit stress/strain&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy stress/strain data to other images&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_STRSTACOPY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy stress/strain&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Save stress/strain data to file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_STRSTASAVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Save stress/strain&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">StrStaEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Load stress/strain data from file&#39;</span><span class="p">,</span> 
            <span class="nb">id</span><span class="o">=</span><span class="n">wxID_STRSTALOAD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Load stress/strain&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># PDF / PDF Controls</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PDFMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;PDF Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;PDF Controls&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Add element to sample composition&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PDFADDELEMENT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Add element&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Delete element from sample composition&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PDFDELELEMENT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete element&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy PDF controls&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_PDFCOPYCONTROLS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy controls&#39;</span><span class="p">)</span>
        <span class="c">#        self.PDFEdit.Append(help=&#39;Load PDF controls from file&#39;,id=wxID_PDFLOADCONTROLS, kind=wx.ITEM_NORMAL,</span>
        <span class="c">#            text=&#39;Load Controls&#39;)</span>
        <span class="c">#        self.PDFEdit.Append(help=&#39;Save PDF controls to file&#39;, id=wxID_PDFSAVECONTROLS, kind=wx.ITEM_NORMAL,</span>
        <span class="c">#            text=&#39;Save controls&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute PDF&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_PDFCOMPUTE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Compute PDF&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PDFEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute all PDFs&#39;</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_PDFCOMPUTEALL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Compute all PDFs&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Phase / General tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataGeneral</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DataGeneral</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;General&#39;</span><span class="p">,</span> <span class="n">helpLbl</span><span class="o">=</span><span class="s">&#39;Phase/General&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataGeneral</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Compute&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute Fourier map&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_FOURCALC</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Fourier map&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Search Fourier map&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_FOURSEARCH</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Search map&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Run charge flipping&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_CHARGEFLIP</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Charge flipping&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">GeneralCalc</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">help</span><span class="o">=</span><span class="s">&#39;Clear map&#39;</span><span class="p">,</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_FOURCLEAR</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;Clear map&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
        
        <span class="c"># Phase / Data tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DataMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Data&#39;</span><span class="p">,</span> <span class="n">helpLbl</span><span class="o">=</span><span class="s">&#39;Phase/Data&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DataEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PWDRADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add powder histograms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select new powder histograms to be used for this phase&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_HKLFADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add single crystal histograms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select new single crystal histograms to be used for this phase&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DATADELETE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete histograms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Delete histograms from use for this phase&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Phase / Atoms tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomsMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">AtomsMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomCompute</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">AtomCompute</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Compute&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSEDITADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Append atom&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Appended as an H atom&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSVIEWADD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Append view point&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Appended as an H atom&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RBAPPEND</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Append rigid body&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Append atoms for rigid body&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSEDITINSERT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Insert atom&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atom row to insert before; inserted as an H atom&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMVIEWINSERT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Insert view point&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atom row to insert before; inserted as an H atom&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMMOVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Move atom to view point&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select single atom to move&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSEDITDELETE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete atom&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms to delete first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSREFINE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Set atom refinement flags&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms to refine first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSMODIFY</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Modify atom parameters&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms to modify first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSTRANSFORM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Transform atoms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms to transform first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RELOADDRAWATOMS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Reload draw atoms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Reload atom drawing list&#39;</span><span class="p">)</span>
        <span class="n">submenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomEdit</span><span class="o">.</span><span class="n">AppendMenu</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span> <span class="s">&#39;Reimport atoms&#39;</span><span class="p">,</span> <span class="n">submenu</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Reimport atoms from file; sequence must match&#39;</span><span class="p">)</span>
        <span class="c"># setup a cascade menu for the formats that have been defined</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReImportMenuId</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c"># points to readers for each menu entry</span>
        <span class="k">for</span> <span class="n">reader</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">G2frame</span><span class="o">.</span><span class="n">ImportPhaseReaderlist</span><span class="p">:</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span>
                <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span><span class="n">help</span><span class="o">=</span><span class="n">reader</span><span class="o">.</span><span class="n">longFormatName</span><span class="p">,</span>
                <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;reimport coordinates from &#39;</span><span class="o">+</span><span class="n">reader</span><span class="o">.</span><span class="n">formatName</span><span class="o">+</span><span class="s">&#39; file&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ReImportMenuId</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="n">reader</span>
        <span class="n">item</span> <span class="o">=</span> <span class="n">submenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">ID_ANY</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Reimport coordinates, try to determine format from file&#39;</span><span class="p">,</span>
            <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span>
            <span class="n">text</span><span class="o">=</span><span class="s">&#39;guess format from file&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ReImportMenuId</span><span class="p">[</span><span class="n">item</span><span class="o">.</span><span class="n">GetId</span><span class="p">()]</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># try all readers</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">AtomCompute</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ATOMSDISAGL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Distances &amp;&amp; Angles&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute distances &amp; angles for selected atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
                 
        <span class="c"># Phase / Draw Options tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DataDrawOptions</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DataDrawOptions</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Draw Options&#39;</span><span class="p">,</span> <span class="n">helpLbl</span><span class="o">=</span><span class="s">&#39;Phase/Draw Options&#39;</span><span class="p">,</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">(</span><span class="n">empty</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
        <span class="c"># Phase / Draw Atoms tab </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Draw Atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomCompute</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRigidBody</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomCompute</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Compute&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Restraints&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomsMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRigidBody</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Rigid body&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWATOMSTYLE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Atom style&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWATOMLABEL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Atom label&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWATOMCOLOR</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Atom color&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select atoms first&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWATOMRESETCOLOR</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Reset atom colors&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Resets all atom colors to defaults&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWVIEWPOINT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;View point&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;View point is 1st atom selected&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWADDEQUIV</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add atoms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add symmetry &amp; cell equivalents to drawing set from selected atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWTRANSFORM</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Transform atoms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Transform selected atoms by symmetry &amp; cell translations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWFILLCOORD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Fill CN-sphere&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Fill coordination sphere for selected atoms&#39;</span><span class="p">)</span>            
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWFILLCELL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Fill unit cell&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Fill unit cell with selected atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWDELETE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete atoms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Delete atoms from drawing set&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomCompute</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWDISTVP</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;View pt. dist.&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute distance of selected atoms from view point&#39;</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomCompute</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWDISAGLTOR</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Dist. Ang. Tors.&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute distance, angle or torsion for 2-4 selected atoms&#39;</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomCompute</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWPLANE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Best plane&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute best plane for 4+ selected atoms&#39;</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWRESTRBOND</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add bond restraint&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add bond restraint for selected atoms (2)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWRESTRANGLE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add angle restraint&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add angle restraint for selected atoms (3: one end 1st)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWRESTRPLANE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add plane restraint&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add plane restraint for selected atoms (4+)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRestraint</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWRESTRCHIRAL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Add chiral restraint&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Add chiral restraint for selected atoms (4: center atom 1st)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DrawAtomRigidBody</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_DRAWDEFINERB</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Define rigid body&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Define rigid body with selected atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Phase / Texture tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TextureMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">TextureMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Texture&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TextureEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TextureMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TextureEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Texture&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TextureEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_REFINETEXTURE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Refine texture&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Refine the texture coefficients from sequential Pawley results&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TextureEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_CLEARTEXTURE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Clear texture&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Clear the texture coefficients&#39;</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Phase / Pawley tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PawleyMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Pawley&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">PawleyEdit</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;Operations&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PAWLEYLOAD</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Pawley create&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Initialize Pawley reflection list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PAWLEYESTIMATE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Pawley estimate&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Estimate initial Pawley intensities&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PawleyEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PAWLEYUPDATE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Pawley update&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Update Pawley intensities with abs(Fobs) from reflection list&#39;</span><span class="p">)</span>
<span class="c">#        self.PawleyEdit.Append(id=wxID_PAWLEYDELETE, kind=wx.ITEM_NORMAL,text=&#39;Pawley delete&#39;,</span>
<span class="c">#            help=&#39;Delete selected Pawley reflection&#39;)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
            
        <span class="c"># Phase / Map peaks tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Map peaks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Map peaks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSMOVE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Move peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Move selected peaks to atom list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSVIEWPT</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;View point&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;View point is 1st peak selected&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSDISTVP</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;View pt. dist.&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Compute distance of selected peaks from view point&#39;</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_SHOWBONDS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Hide bonds&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Hide or show bonds between peak positions&#39;</span><span class="p">)</span>   
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSDA</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Calc dist/ang&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Calculate distance or angle for selection&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_FINDEQVPEAKS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Equivalent peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Find equivalent peaks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSUNIQUE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Unique peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select unique set&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSDELETE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Delete peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Delete selected peaks&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MapPeaksEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_PEAKSCLEAR</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Clear peaks&#39;</span><span class="p">,</span> 
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Clear the map peak list&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>

        <span class="c"># Phase / Rigid bodies tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesMenu</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MenuBar</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PrefillDataMenu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesMenu</span><span class="p">,</span><span class="n">helpType</span><span class="o">=</span><span class="s">&#39;Rigid bodies&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Menu</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesMenu</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="n">menu</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s">&#39;Edit&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_ASSIGNATMS2RB</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Assign atoms to rigid body&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Select &amp; position rigid body in structure of existing atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_AUTOFINDRESRB</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Auto find residues&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Auto find of residue RBs in macromolecule&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_COPYRBPARMS</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Copy rigid body parms&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Copy rigid body location &amp; TLS parameters&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_GLOBALRESREFINE</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Global residue refine&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Global setting of residue RB refinement flags&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">RigidBodiesEdit</span><span class="o">.</span><span class="n">Append</span><span class="p">(</span><span class="nb">id</span><span class="o">=</span><span class="n">wxID_RBREMOVEALL</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">ITEM_NORMAL</span><span class="p">,</span><span class="n">text</span><span class="o">=</span><span class="s">&#39;Remove all rigid bodies&#39;</span><span class="p">,</span>
            <span class="n">help</span><span class="o">=</span><span class="s">&#39;Remove all rigid body assignment for atoms&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PostfillDataMenu</span><span class="p">()</span>
    <span class="c"># end of GSAS-II menu definitions</span>
        
    <span class="k">def</span> <span class="nf">_init_ctrls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="n">parent</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">DEFAULT_FRAME_STYLE</span> <span class="o">^</span> <span class="n">wx</span><span class="o">.</span><span class="n">CLOSE_BOX</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">FRAME_FLOAT_ON_PARENT</span> <span class="p">,</span>
            <span class="n">size</span><span class="o">=</span><span class="n">size</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="n">pos</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s">&#39;GSAS-II data display&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_menus</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">Show</span><span class="p">()</span>
        
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="n">frame</span><span class="p">,</span><span class="n">data</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span><span class="n">pos</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">G2frame</span> <span class="o">=</span> <span class="n">frame</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_init_ctrls</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="n">name</span><span class="p">,</span><span class="n">size</span><span class="p">,</span><span class="n">pos</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="n">clientSize</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ClientDisplayRect</span><span class="p">()</span>
        <span class="n">Size</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSize</span><span class="p">()</span>
        <span class="n">xPos</span> <span class="o">=</span> <span class="n">clientSize</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">Size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetPosition</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">xPos</span><span class="p">,</span><span class="n">clientSize</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="mi">250</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">AtomGrid</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">selectedRow</span> <span class="o">=</span> <span class="mi">0</span>
        
    <span class="k">def</span> <span class="nf">setSizePosLeft</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">Width</span><span class="p">):</span>
        <span class="n">clientSize</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ClientDisplayRect</span><span class="p">()</span>
        <span class="n">Width</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">Width</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span><span class="n">clientSize</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="mi">300</span><span class="p">)</span>
        <span class="n">Width</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">Width</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="mi">300</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">Width</span><span class="p">)</span>
<span class="c">#        self.SetPosition(wx.Point(clientSize[2]-Width[0],clientSize[1]+250))</span>
        
    <span class="k">def</span> <span class="nf">Clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ClearBackground</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">DestroyChildren</span><span class="p">()</span>
                   
<span class="c">################################################################################</span>
<span class="c">#####  GSNotebook</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="GSNoteBook"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.GSNoteBook">[docs]</a><span class="k">class</span> <span class="nc">GSNoteBook</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiNotebook</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Notebook used in various locations; implemented with wx.aui extension</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">size</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AuiNotebook</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>
                                    <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_TOP</span> <span class="o">|</span>
                                    <span class="n">wx</span><span class="o">.</span><span class="n">aui</span><span class="o">.</span><span class="n">AUI_NB_SCROLL_BUTTONS</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">size</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">size</span><span class="p">)</span>
                                                      
    <span class="k">def</span> <span class="nf">Clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>        
        <span class="n">GSNoteBook</span><span class="o">.</span><span class="n">DeleteAllPages</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">FindPage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">name</span><span class="p">):</span>
        <span class="n">numPage</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPageCount</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">page</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numPage</span><span class="p">):</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetPageText</span><span class="p">(</span><span class="n">page</span><span class="p">)</span> <span class="o">==</span> <span class="n">name</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">page</span>

    <span class="c"># def __getattribute__(self,name):</span>
    <span class="c">#     &#39;&#39;&#39;This method provides a way to print out a message every time</span>
    <span class="c">#     that a method in a class is called -- to see what all the calls</span>
    <span class="c">#     might be, or where they might be coming from.</span>
    <span class="c">#     Cute trick for debugging!</span>
    <span class="c">#     &#39;&#39;&#39;</span>
    <span class="c">#     attr = object.__getattribute__(self, name)</span>
    <span class="c">#     if hasattr(attr, &#39;__call__&#39;):</span>
    <span class="c">#         def newfunc(*args, **kwargs):</span>
    <span class="c">#             print(&#39;GSauiNoteBook calling %s&#39; %attr.__name__)</span>
    <span class="c">#             result = attr(*args, **kwargs)</span>
    <span class="c">#             return result</span>
    <span class="c">#         return newfunc</span>
    <span class="c">#     else:</span>
    <span class="c">#         return attr</span>
            
<span class="c">################################################################################</span>
<span class="c">#####  GSGrid</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="GSGrid"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.GSGrid">[docs]</a><span class="k">class</span> <span class="nc">GSGrid</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">Grid</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Basic wx.Grid implementation</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s">&#39;&#39;</span><span class="p">):</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">Grid</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>                    
        <span class="c">#self.SetSize(parent.GetClientSize())</span>
        <span class="c"># above removed to speed drawing of initial grid</span>
        <span class="c"># does not appear to be needed</span>
            
    <span class="k">def</span> <span class="nf">Clear</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">Grid</span><span class="o">.</span><span class="n">ClearGrid</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">SetCellStyle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s">&quot;white&quot;</span><span class="p">,</span><span class="n">readonly</span><span class="o">=</span><span class="bp">True</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetCellBackgroundColour</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">color</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetReadOnly</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">c</span><span class="p">,</span><span class="n">isReadOnly</span><span class="o">=</span><span class="n">readonly</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">GetSelection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c">#this is to satisfy structure drawing stuff in G2plt when focus changes</span>
        <span class="k">return</span> <span class="bp">None</span>
                                                
<span class="c">################################################################################</span>
<span class="c">#####  Table</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="Table"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.Table">[docs]</a><span class="k">class</span> <span class="nc">Table</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">PyGridTableBase</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Basic data table for use with GSgrid</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">[],</span> <span class="n">rowLabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">colLabels</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">types</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">PyGridTableBase</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span> <span class="o">=</span> <span class="n">colLabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rowLabels</span> <span class="o">=</span> <span class="n">rowLabels</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataTypes</span> <span class="o">=</span> <span class="n">types</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">AppendRows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">numRows</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
        <span class="k">return</span> <span class="bp">True</span>
        
    <span class="k">def</span> <span class="nf">CanGetValueAs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">typeName</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTypes</span><span class="p">:</span>
            <span class="n">colType</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">typeName</span> <span class="o">==</span> <span class="n">colType</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">False</span>

    <span class="k">def</span> <span class="nf">CanSetValueAs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">typeName</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CanGetValueAs</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">typeName</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">DeleteRow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">pos</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetData</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetData</span><span class="p">([])</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">irow</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">irow</span> <span class="o">&lt;&gt;</span> <span class="n">pos</span><span class="p">:</span>
                <span class="n">new</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">SetData</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">GetColLabelValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
            
    <span class="k">def</span> <span class="nf">GetData</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetRowValues</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">GetNumberCols</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
        
    <span class="k">def</span> <span class="nf">GetNumberRows</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">GetRowLabelValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowLabels</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowLabels</span><span class="p">[</span><span class="n">row</span><span class="p">]</span>
        
    <span class="k">def</span> <span class="nf">GetColValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">GetRowValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()):</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">data</span>
        
    <span class="k">def</span> <span class="nf">GetTypeName</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">dataTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>

    <span class="k">def</span> <span class="nf">GetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">None</span>
            
    <span class="k">def</span> <span class="nf">InsertRows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pos</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">pos</span><span class="p">,[])</span>
            <span class="n">pos</span> <span class="o">+=</span> <span class="mi">1</span>
        
    <span class="k">def</span> <span class="nf">IsEmptyCell</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span>
        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">True</span>
        
    <span class="k">def</span> <span class="nf">OnKeyPress</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="n">dellist</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetSelectedRows</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">GetKeyCode</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">WXK_DELETE</span> <span class="ow">and</span> <span class="n">dellist</span><span class="p">:</span>
            <span class="n">grid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetView</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">dellist</span><span class="p">:</span> <span class="n">grid</span><span class="o">.</span><span class="n">DeleteRow</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
                
    <span class="k">def</span> <span class="nf">SetColLabelValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="n">numcols</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="n">numcols</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">colLabels</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">=</span><span class="n">label</span>
        
    <span class="k">def</span> <span class="nf">SetData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">SetRowValues</span><span class="p">(</span><span class="n">row</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">])</span>
                
    <span class="k">def</span> <span class="nf">SetRowLabelValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">label</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rowLabels</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">=</span><span class="n">label</span>
            
    <span class="k">def</span> <span class="nf">SetRowValues</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">row</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
            
    <span class="k">def</span> <span class="nf">SetValue</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="k">def</span> <span class="nf">innerSetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="k">except</span> <span class="ne">TypeError</span><span class="p">:</span>
                <span class="k">return</span>
            <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                <span class="k">print</span> <span class="n">row</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">value</span>
                <span class="c"># add a new row</span>
                <span class="k">if</span> <span class="n">row</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">():</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="s">&#39;&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">())</span>
                <span class="k">elif</span> <span class="n">col</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">GetNumberCols</span><span class="p">():</span>
                    <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">):</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
                <span class="k">print</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">row</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">innerSetValue</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
<span class="c">################################################################################</span>
<span class="c">#### Help</span>
<span class="c">################################################################################</span>
</div>
<div class="viewcode-block" id="ShowHelp"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.ShowHelp">[docs]</a><span class="k">def</span> <span class="nf">ShowHelp</span><span class="p">(</span><span class="n">helpType</span><span class="p">,</span><span class="n">frame</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Called to bring up a web page for documentation.&#39;&#39;&#39;</span>
    <span class="k">global</span> <span class="n">htmlFirstUse</span>
    <span class="c"># look up a definition for help info from dict</span>
    <span class="n">helplink</span> <span class="o">=</span> <span class="n">helpLocDict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">helpType</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">helplink</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
        <span class="c"># no defined link to use, create a default based on key</span>
        <span class="n">helplink</span> <span class="o">=</span> <span class="s">&#39;gsasII.html#&#39;</span><span class="o">+</span><span class="n">helpType</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&#39; &#39;</span><span class="p">,</span><span class="s">&#39;_&#39;</span><span class="p">)</span>
    <span class="n">helplink</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path2GSAS2</span><span class="p">,</span><span class="s">&#39;help&#39;</span><span class="p">,</span><span class="n">helplink</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">helpMode</span> <span class="o">==</span> <span class="s">&#39;internal&#39;</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">htmlPanel</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="n">helplink</span><span class="p">)</span>
            <span class="n">htmlFrame</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="n">htmlFrame</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Frame</span><span class="p">(</span><span class="n">frame</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">610</span><span class="p">,</span> <span class="mi">510</span><span class="p">))</span>
            <span class="n">htmlFrame</span><span class="o">.</span><span class="n">Show</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">htmlFrame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&quot;HTML Window&quot;</span><span class="p">)</span> <span class="c"># N.B. reset later in LoadFile</span>
            <span class="n">htmlPanel</span> <span class="o">=</span> <span class="n">MyHtmlPanel</span><span class="p">(</span><span class="n">htmlFrame</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">htmlPanel</span><span class="o">.</span><span class="n">LoadFile</span><span class="p">(</span><span class="n">helplink</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">pfx</span> <span class="o">=</span> <span class="s">&quot;file://&quot;</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s">&#39;win&#39;</span><span class="p">):</span>
            <span class="n">pfx</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="n">htmlFirstUse</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open_new</span><span class="p">(</span><span class="n">pfx</span><span class="o">+</span><span class="n">helplink</span><span class="p">)</span>
            <span class="n">htmlFirstUse</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">webbrowser</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">pfx</span><span class="o">+</span><span class="n">helplink</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">autoraise</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

<span class="c">################################################################################</span>
<span class="c">#####  Notebook</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="UpdateNotebook"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.UpdateNotebook">[docs]</a><span class="k">def</span> <span class="nf">UpdateNotebook</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Called when the data tree notebook entry is selected. Allows for</span>
<span class="sd">    editing of the text in that tree entry</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">OnNoteBook</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">,</span><span class="s">&#39;Notebook&#39;</span><span class="p">),</span><span class="n">data</span><span class="p">)</span>
                    
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">&#39;Notebook&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetClientSize</span><span class="p">(),</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span> <span class="o">|</span> <span class="n">wx</span><span class="o">.</span><span class="n">TE_DONTWRAP</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnNoteBook</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnNoteBook</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="s">&#39;Notebook entry @ &#39;</span><span class="o">+</span><span class="n">time</span><span class="o">.</span><span class="n">ctime</span><span class="p">()</span><span class="o">+</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">([</span><span class="mi">400</span><span class="p">,</span><span class="mi">250</span><span class="p">])</span>
            
<span class="c">################################################################################</span>
<span class="c">#####  Controls</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="UpdateControls"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.UpdateControls">[docs]</a><span class="k">def</span> <span class="nf">UpdateControls</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Edit overall GSAS-II controls in main Controls data tree entry</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="c">#patch</span>
    <span class="k">if</span> <span class="s">&#39;deriv type&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s">&#39;analytic Hessian&#39;</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;min dM/M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;shift factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>        
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;F**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;minF/sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">if</span> <span class="s">&#39;shift factor&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;shift factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.</span>
    <span class="k">if</span> <span class="s">&#39;max cyc&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="s">&#39;F**2&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;F**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;minF/sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="c">#end patch</span>

    <span class="k">def</span> <span class="nf">SeqSizer</span><span class="p">():</span>
        
        <span class="k">def</span> <span class="nf">OnSelectData</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;All&#39;</span><span class="p">,]</span><span class="o">+</span><span class="n">GetPatternTreeDataNames</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,[</span><span class="s">&#39;PWDR&#39;</span><span class="p">,])</span>
            <span class="n">sel</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="s">&#39;Seq Data&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Seq Data&#39;</span><span class="p">]:</span>
                    <span class="n">sel</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">choices</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">MultiChoiceDialog</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="s">&#39;Select data:&#39;</span><span class="p">,</span><span class="s">&#39;Sequential refinement&#39;</span><span class="p">,</span><span class="n">choices</span><span class="p">)</span>
            <span class="n">dlg</span><span class="o">.</span><span class="n">SetSelections</span><span class="p">(</span><span class="n">sel</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                <span class="n">sel</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetSelections</span><span class="p">()</span>
                <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sel</span><span class="p">:</span> <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">choices</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="s">&#39;All&#39;</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                    <span class="n">names</span> <span class="o">=</span> <span class="n">choices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="n">data</span><span class="p">[</span><span class="s">&#39;Seq Data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">names</span>                
            <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
            <span class="n">reverseSel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            
        <span class="k">def</span> <span class="nf">OnReverse</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;Reverse Seq&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">reverseSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
                    
        <span class="n">seqSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
        <span class="n">seqSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Sequential Refinement Powder Data: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">selSeqData</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Button</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Select data&#39;</span><span class="p">)</span>
        <span class="n">selSeqData</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_BUTTON</span><span class="p">,</span><span class="n">OnSelectData</span><span class="p">)</span>
        <span class="n">seqSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">selSeqData</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">seqSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">reverseSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Reverse order?&#39;</span><span class="p">)</span>
        <span class="n">reverseSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">,</span><span class="n">OnReverse</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;Seq Data&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">reverseSel</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;Reverse Seq&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">reverseSel</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Reverse Seq&#39;</span><span class="p">])</span>
        <span class="n">seqSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">reverseSel</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">seqSizer</span>
        
    <span class="k">def</span> <span class="nf">LSSizer</span><span class="p">():</span>        
        
        <span class="k">def</span> <span class="nf">OnDerivType</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">derivSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
            <span class="n">derivSel</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">])</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">CallAfter</span><span class="p">(</span><span class="n">UpdateControls</span><span class="p">,</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            
        <span class="k">def</span> <span class="nf">OnConvergence</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mf">1.e-9</span><span class="p">,</span><span class="nb">min</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span><span class="nb">float</span><span class="p">(</span><span class="n">Cnvrg</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())))</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">0.0001</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;min dM/M&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">Cnvrg</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%.2g</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            
        <span class="k">def</span> <span class="nf">OnMaxCycles</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">maxCyc</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
            <span class="n">maxCyc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]))</span>
                        
        <span class="k">def</span> <span class="nf">OnFactor</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">Factr</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()),</span><span class="mf">0.00001</span><span class="p">),</span><span class="mf">100.</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;shift factor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">Factr</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%.5f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>
            
        <span class="k">def</span> <span class="nf">OnFsqRef</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;F**2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fsqRef</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        
        <span class="k">def</span> <span class="nf">OnMinSig</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">minSig</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()),</span><span class="mf">0.</span><span class="p">),</span><span class="mf">5.</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
                <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="n">data</span><span class="p">[</span><span class="s">&#39;minF/sig&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
            <span class="n">minSig</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">value</span><span class="p">))</span>

        <span class="n">LSSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FlexGridSizer</span><span class="p">(</span><span class="n">cols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span><span class="n">vgap</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span><span class="n">hgap</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
        <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Refinement derivatives: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">Choice</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;analytic Jacobian&#39;</span><span class="p">,</span><span class="s">&#39;numeric&#39;</span><span class="p">,</span><span class="s">&#39;analytic Hessian&#39;</span><span class="p">]</span>
        <span class="n">derivSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">],</span><span class="n">choices</span><span class="o">=</span><span class="n">Choice</span><span class="p">,</span>
            <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_DROPDOWN</span><span class="p">)</span>
        <span class="n">derivSel</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">])</span>
        <span class="n">derivSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="n">OnDerivType</span><span class="p">)</span>
            
        <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">derivSel</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Min delta-M/M: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="n">Cnvrg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.2g</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;min dM/M&#39;</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
        <span class="n">Cnvrg</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnConvergence</span><span class="p">)</span>
        <span class="n">Cnvrg</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnConvergence</span><span class="p">)</span>
        <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Cnvrg</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;Hessian&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;deriv type&#39;</span><span class="p">]:</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Max cycles: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">Choice</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;0&#39;</span><span class="p">,</span><span class="s">&#39;1&#39;</span><span class="p">,</span><span class="s">&#39;2&#39;</span><span class="p">,</span><span class="s">&#39;3&#39;</span><span class="p">,</span><span class="s">&#39;5&#39;</span><span class="p">,</span><span class="s">&#39;10&#39;</span><span class="p">,</span><span class="s">&#39;15&#39;</span><span class="p">,</span><span class="s">&#39;20&#39;</span><span class="p">]</span>
            <span class="n">maxCyc</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]),</span><span class="n">choices</span><span class="o">=</span><span class="n">Choice</span><span class="p">,</span>
                <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_DROPDOWN</span><span class="p">)</span>
            <span class="n">maxCyc</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;max cyc&#39;</span><span class="p">]))</span>
            <span class="n">maxCyc</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="n">OnMaxCycles</span><span class="p">)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">maxCyc</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Initial shift factor: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">Factr</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.5f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;shift factor&#39;</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
            <span class="n">Factr</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnFactor</span><span class="p">)</span>
            <span class="n">Factr</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnFactor</span><span class="p">)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">Factr</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">Sngl</span><span class="p">:</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">),)</span>
            <span class="n">fsqRef</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">CheckBox</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Refine HKLF as F^2? &#39;</span><span class="p">)</span>
            <span class="n">fsqRef</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;F**2&#39;</span><span class="p">])</span>
            <span class="n">fsqRef</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_CHECKBOX</span><span class="p">,</span><span class="n">OnFsqRef</span><span class="p">)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">fsqRef</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39;Min obs/sig (0-5): &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
            <span class="n">minSig</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="s">&#39;</span><span class="si">%.2f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;minF/sig&#39;</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
            <span class="n">minSig</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnMinSig</span><span class="p">)</span>
            <span class="n">minSig</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnMinSig</span><span class="p">)</span>
            <span class="n">LSSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">minSig</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">LSSizer</span>
        
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetStatusBar</span><span class="p">():</span>
        <span class="n">Status</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">CreateStatusBar</span><span class="p">()</span>
        <span class="n">Status</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">&#39;Controls&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">)</span>
    <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">ControlsMenu</span><span class="p">)</span>
    <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Refinement Controls:&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>    
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">LSSizer</span><span class="p">())</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">SeqSizer</span><span class="p">())</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
        
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>    
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">mainSizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">))</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">mainSizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">))</span>
     
<span class="c">################################################################################</span>
<span class="c">#####  Comments</span>
<span class="c">################################################################################           </span>
       </div>
<span class="k">def</span> <span class="nf">UpdateComments</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>                   

    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">&#39;Comments&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetClientSize</span><span class="p">(),</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_DONTWRAP</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">AppendText</span><span class="p">(</span><span class="n">line</span><span class="o">+</span><span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">([</span><span class="mi">400</span><span class="p">,</span><span class="mi">250</span><span class="p">])</span>
            
<span class="c">################################################################################</span>
<span class="c">#####  Sequential Results</span>
<span class="c">################################################################################           </span>
       
<div class="viewcode-block" id="UpdateSeqResults"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.UpdateSeqResults">[docs]</a><span class="k">def</span> <span class="nf">UpdateSeqResults</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Called when the Sequential Results data tree entry is selected</span>
<span class="sd">    to show results from a sequential refinement.</span>
<span class="sd">    </span>
<span class="sd">    :param wx.Frame G2frame: main GSAS-II data tree windows</span>

<span class="sd">    :param dict data: a dictionary containing the following items:  </span>

<span class="sd">            * &#39;histNames&#39; - list of histogram names in order as processed by Sequential Refinement</span>
<span class="sd">            * &#39;varyList&#39; - list of variables - identical over all refinements in sequence</span>
<span class="sd">            * &#39;histName&#39; - dictionaries for all data sets processed, which contains:</span>

<span class="sd">              * &#39;variables&#39;- result[0] from leastsq call</span>
<span class="sd">              * &#39;varyList&#39; - list of variables; same as above</span>
<span class="sd">              * &#39;sig&#39; - esds for variables</span>
<span class="sd">              * &#39;covMatrix&#39; - covariance matrix from individual refinement</span>
<span class="sd">              * &#39;title&#39; - histogram name; same as dict item name</span>
<span class="sd">              * &#39;newAtomDict&#39; - new atom parameters after shifts applied</span>
<span class="sd">              * &#39;newCellDict&#39; - new cell parameters after shifts to A0-A5 applied&#39;</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;No sequential refinement results&#39;</span>
        <span class="k">return</span>
    <span class="n">histNames</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;histNames&#39;</span><span class="p">]</span>
       
    <span class="k">def</span> <span class="nf">GetSampleParms</span><span class="p">():</span>
        <span class="n">sampleParmDict</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Temperature&#39;</span><span class="p">:[],</span><span class="s">&#39;Pressure&#39;</span><span class="p">:[],</span><span class="s">&#39;Humidity&#39;</span><span class="p">:[],</span><span class="s">&#39;Voltage&#39;</span><span class="p">:[],</span><span class="s">&#39;Force&#39;</span><span class="p">:[],}</span>
        <span class="n">sampleParm</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">histNames</span><span class="p">:</span>
            <span class="n">Id</span> <span class="o">=</span> <span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
            <span class="n">sampleData</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">Id</span><span class="p">,</span><span class="s">&#39;Sample Parameters&#39;</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sampleParmDict</span><span class="p">:</span>
                <span class="n">sampleParmDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sampleData</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">sampleParmDict</span><span class="p">:</span>
            <span class="n">frstValue</span> <span class="o">=</span> <span class="n">sampleParmDict</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">any</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">sampleParmDict</span><span class="p">[</span><span class="n">item</span><span class="p">])</span><span class="o">-</span><span class="n">frstValue</span><span class="p">):</span>
                <span class="n">sampleParm</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="o">=</span> <span class="n">sampleParmDict</span><span class="p">[</span><span class="n">item</span><span class="p">]</span>            
        <span class="k">return</span> <span class="n">sampleParm</span>
            
    <span class="k">def</span> <span class="nf">GetRwps</span><span class="p">():</span>
        <span class="n">Rwps</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">histNames</span><span class="p">:</span>
            <span class="n">Rwps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;Rvals&#39;</span><span class="p">][</span><span class="s">&#39;Rwp&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">Rwps</span>
            
    <span class="k">def</span> <span class="nf">GetSigData</span><span class="p">(</span><span class="n">parm</span><span class="p">):</span>
        <span class="n">sigData</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">histNames</span><span class="p">:</span>
            <span class="n">sigList</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;sig&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">colLabels</span><span class="p">[</span><span class="n">parm</span><span class="p">]</span> <span class="ow">in</span> <span class="n">atomList</span><span class="p">:</span>
                <span class="n">sigData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigList</span><span class="p">[</span><span class="n">colLabels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">atomList</span><span class="p">[</span><span class="n">colLabels</span><span class="p">[</span><span class="n">parm</span><span class="p">]])</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">elif</span> <span class="n">colLabels</span><span class="p">[</span><span class="n">parm</span><span class="p">]</span> <span class="ow">in</span> <span class="n">cellList</span><span class="p">:</span>
                <span class="n">sigData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigList</span><span class="p">[</span><span class="n">colLabels</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">cellList</span><span class="p">[</span><span class="n">colLabels</span><span class="p">[</span><span class="n">parm</span><span class="p">]])</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sigData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sigList</span><span class="p">[</span><span class="n">parm</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">sigData</span>
    
    <span class="k">def</span> <span class="nf">Select</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">cols</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetSelectedCols</span><span class="p">()</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetSelectedRows</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">plotData</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">plotSig</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">plotNames</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">plotData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetColValues</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">col</span><span class="p">:</span>     <span class="c">#not Rwp</span>
                    <span class="n">plotSig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">GetSigData</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">plotSig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                <span class="n">plotNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetColLabelValue</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
            <span class="n">plotData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">plotData</span><span class="p">)</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSeq</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">plotData</span><span class="p">,</span><span class="n">plotSig</span><span class="p">,</span><span class="n">plotNames</span><span class="p">,</span><span class="n">sampleParms</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">rows</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">histNames</span><span class="p">[</span><span class="n">rows</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>       <span class="c">#only does 1st one selected</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotCovariance</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">])</span>
            
    <span class="k">def</span> <span class="nf">OnSaveSelSeq</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>        
        <span class="n">cols</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetSelectedCols</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">cols</span><span class="p">:</span>
            <span class="n">numRows</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetNumberRows</span><span class="p">()</span>
            <span class="n">dataNames</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">saveNames</span> <span class="o">=</span> <span class="p">[</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetRowLabelValue</span><span class="p">(</span><span class="n">r</span><span class="p">)</span> <span class="k">for</span> <span class="n">r</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">numRows</span><span class="p">)]</span>
            <span class="n">saveData</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">cols</span><span class="p">:</span>
                <span class="n">dataNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetColLabelValue</span><span class="p">(</span><span class="n">col</span><span class="p">))</span>
                <span class="k">if</span> <span class="n">col</span><span class="p">:</span>     <span class="c">#not Rwp</span>
                    <span class="n">saveData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetColValues</span><span class="p">(</span><span class="n">col</span><span class="p">),</span><span class="n">GetSigData</span><span class="p">(</span><span class="n">col</span><span class="p">)))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">saveData</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="o">.</span><span class="n">GetColValues</span><span class="p">(</span><span class="n">col</span><span class="p">),</span><span class="mf">0.0</span><span class="p">))</span>
            <span class="n">lenName</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">saveNames</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">saveData</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">swapaxes</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">saveData</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">dlg</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">FileDialog</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span> <span class="s">&#39;Choose text output file for your selection&#39;</span><span class="p">,</span> <span class="s">&#39;.&#39;</span><span class="p">,</span> <span class="s">&#39;&#39;</span><span class="p">,</span> 
                <span class="s">&#39;Text output file (*.txt)|*.txt&#39;</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_SAVE</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">FD_OVERWRITE_PROMPT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CHANGE_DIR</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">dlg</span><span class="o">.</span><span class="n">ShowModal</span><span class="p">()</span> <span class="o">==</span> <span class="n">wx</span><span class="o">.</span><span class="n">ID_OK</span><span class="p">:</span>
                    <span class="n">SeqTextFile</span> <span class="o">=</span> <span class="n">dlg</span><span class="o">.</span><span class="n">GetPath</span><span class="p">()</span>
                    <span class="n">SeqTextFile</span> <span class="o">=</span> <span class="n">G2IO</span><span class="o">.</span><span class="n">FileDlgFixExt</span><span class="p">(</span><span class="n">dlg</span><span class="p">,</span><span class="n">SeqTextFile</span><span class="p">)</span>
                    <span class="n">SeqFile</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">SeqTextFile</span><span class="p">,</span><span class="s">&#39;w&#39;</span><span class="p">)</span>
                    <span class="n">line</span> <span class="o">=</span> <span class="s">&#39;  </span><span class="si">%s</span><span class="s">  &#39;</span><span class="o">%</span><span class="p">(</span><span class="s">&#39;name&#39;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="n">lenName</span><span class="p">))</span>
                    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">dataNames</span><span class="p">:</span>
                        <span class="n">line</span> <span class="o">+=</span> <span class="s">&#39; </span><span class="si">%12s</span><span class="s"> </span><span class="si">%12s</span><span class="s"> &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">12</span><span class="p">),</span><span class="s">&#39;esd&#39;</span><span class="o">.</span><span class="n">center</span><span class="p">(</span><span class="mi">12</span><span class="p">))</span>
                    <span class="n">line</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                    <span class="n">SeqFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">saveData</span><span class="p">):</span>
                        <span class="n">line</span> <span class="o">=</span> <span class="s">&quot; &#39;</span><span class="si">%s</span><span class="s">&#39; &quot;</span><span class="o">%</span><span class="p">(</span><span class="n">saveNames</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                        <span class="k">for</span> <span class="n">val</span><span class="p">,</span><span class="n">esd</span> <span class="ow">in</span> <span class="n">item</span><span class="p">:</span>
                            <span class="n">line</span> <span class="o">+=</span> <span class="s">&#39; </span><span class="si">%12.6f</span><span class="s"> </span><span class="si">%12.6f</span><span class="s"> &#39;</span><span class="o">%</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="n">esd</span><span class="p">)</span>
                        <span class="n">line</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">&#39;</span>
                        <span class="n">SeqFile</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
                    <span class="n">SeqFile</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">finally</span><span class="p">:</span>
                <span class="n">dlg</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
            
               
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="n">atomList</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newAtomDict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">histNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s">&#39;newAtomDict&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newAtomDict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;varyList&#39;</span><span class="p">]:</span>
            <span class="n">atomList</span><span class="p">[</span><span class="n">newAtomDict</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span>
    <span class="n">cellList</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">newCellDict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">histNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s">&#39;newCellDict&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">newCellDict</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;varyList&#39;</span><span class="p">]:</span>
            <span class="n">cellList</span><span class="p">[</span><span class="n">newCellDict</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">]]</span> <span class="o">=</span> <span class="n">item</span>
    <span class="n">sampleParms</span> <span class="o">=</span> <span class="n">GetSampleParms</span><span class="p">()</span>
    <span class="n">Rwps</span> <span class="o">=</span> <span class="n">GetRwps</span><span class="p">()</span>
    <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SequentialMenu</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">&#39;Sequential refinement results&#39;</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">CreateStatusBar</span><span class="p">()</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span> <span class="n">OnSaveSelSeq</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_SAVESEQSEL</span><span class="p">)</span>
    <span class="n">colLabels</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Rwp&#39;</span><span class="p">,]</span><span class="o">+</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;varyList&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">atomList</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">+</span><span class="n">cellList</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="n">Types</span> <span class="o">=</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;varyList&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">atomList</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span><span class="o">+</span><span class="n">cellList</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">[</span><span class="n">wg</span><span class="o">.</span><span class="n">GRID_VALUE_FLOAT</span><span class="p">,]</span>
    <span class="n">seqList</span> <span class="o">=</span> <span class="p">[[</span><span class="n">Rwps</span><span class="p">[</span><span class="n">i</span><span class="p">],]</span><span class="o">+</span><span class="nb">list</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">][</span><span class="s">&#39;variables&#39;</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">name</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">histNames</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">item</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">seqList</span><span class="p">):</span>
        <span class="n">newAtomDict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">histNames</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s">&#39;newAtomDict&#39;</span><span class="p">]</span>
        <span class="n">newCellDict</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">histNames</span><span class="p">[</span><span class="n">i</span><span class="p">]][</span><span class="s">&#39;newCellDict&#39;</span><span class="p">]</span>
        <span class="n">item</span> <span class="o">+=</span> <span class="p">[</span><span class="n">newAtomDict</span><span class="p">[</span><span class="n">atomList</span><span class="p">[</span><span class="n">parm</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">parm</span> <span class="ow">in</span> <span class="n">atomList</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
        <span class="n">item</span> <span class="o">+=</span> <span class="p">[</span><span class="n">newCellDict</span><span class="p">[</span><span class="n">cellList</span><span class="p">[</span><span class="n">parm</span><span class="p">]][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">parm</span> <span class="ow">in</span> <span class="n">cellList</span><span class="o">.</span><span class="n">keys</span><span class="p">()]</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span> <span class="o">=</span> <span class="n">Table</span><span class="p">(</span><span class="n">seqList</span><span class="p">,</span><span class="n">colLabels</span><span class="o">=</span><span class="n">colLabels</span><span class="p">,</span><span class="n">rowLabels</span><span class="o">=</span><span class="n">histNames</span><span class="p">,</span><span class="n">types</span><span class="o">=</span><span class="n">Types</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">GSGrid</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetTable</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">SeqTable</span><span class="p">,</span> <span class="bp">True</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">EnableEditing</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wg</span><span class="o">.</span><span class="n">EVT_GRID_LABEL_LEFT_DCLICK</span><span class="p">,</span> <span class="n">Select</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetRowLabelSize</span><span class="p">(</span><span class="mi">8</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">histNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>       <span class="c">#pretty arbitrary 8</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetMargins</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">AutoSizeColumns</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">([</span><span class="mi">700</span><span class="p">,</span><span class="mi">350</span><span class="p">])</span>
        
<span class="c">################################################################################</span>
<span class="c">#####  Main PWDR panel</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="UpdatePWHKPlot"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.UpdatePWHKPlot">[docs]</a><span class="k">def</span> <span class="nf">UpdatePWHKPlot</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">kind</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Not sure what this does</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">def</span> <span class="nf">OnErrorAnalysis</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotDeltSig</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">kind</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">OnWtFactor</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">wtval</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span>
        <span class="k">except</span> <span class="ne">ValueError</span><span class="p">:</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;wtFactor&#39;</span><span class="p">]</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;wtFactor&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span>
        <span class="n">wtval</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">val</span><span class="p">))</span>
           
    <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">if</span> <span class="s">&#39;wtFactor&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;wtFactor&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">}</span>
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">ErrorMenu</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_MENU</span><span class="p">,</span><span class="n">OnErrorAnalysis</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">wxID_PWDANALYSIS</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">)</span>
    
    <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),)</span>
    <span class="n">wtSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
    <span class="n">wtSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39; Weight factor: &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">wtval</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="s">&#39;</span><span class="si">%.3f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s">&#39;wtFactor&#39;</span><span class="p">]),</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_PROCESS_ENTER</span><span class="p">)</span>
    <span class="n">wtval</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_TEXT_ENTER</span><span class="p">,</span><span class="n">OnWtFactor</span><span class="p">)</span>
    <span class="n">wtval</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_KILL_FOCUS</span><span class="p">,</span><span class="n">OnWtFactor</span><span class="p">)</span>
    <span class="n">wtSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wtval</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wtSizer</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>    
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">mainSizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">))</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="o">==</span> <span class="s">&#39;PWDR&#39;</span><span class="p">:</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">kind</span> <span class="o">==</span> <span class="s">&#39;HKLF&#39;</span><span class="p">:</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
                 
<span class="c">################################################################################</span>
<span class="c">#####  HKLF controls</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="UpdateHKLControls"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.UpdateHKLControls">[docs]</a><span class="k">def</span> <span class="nf">UpdateHKLControls</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Not sure what this does</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
    <span class="k">def</span> <span class="nf">OnScaleSlider</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">scaleSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">())</span><span class="o">/</span><span class="mf">1000.</span>
        <span class="n">scaleSel</span><span class="o">.</span><span class="n">SetValue</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">scale</span><span class="o">*</span><span class="mf">1000.</span><span class="p">))</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;Scale&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">scale</span><span class="o">*</span><span class="mf">1.</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">OnLayerSlider</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">layer</span> <span class="o">=</span> <span class="n">layerSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;Layer&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">layer</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">OnSelZone</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;Zone&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">zoneSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">izone</span> <span class="o">=</span> <span class="n">zones</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Zone&#39;</span><span class="p">])</span>
        <span class="n">layerSel</span><span class="o">.</span><span class="n">SetRange</span><span class="p">(</span><span class="n">maxValue</span><span class="o">=</span><span class="n">HKLmax</span><span class="p">[</span><span class="n">izone</span><span class="p">],</span><span class="n">minValue</span><span class="o">=</span><span class="n">HKLmin</span><span class="p">[</span><span class="n">izone</span><span class="p">])</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">OnSelType</span><span class="p">(</span><span class="n">event</span><span class="p">):</span>
        <span class="n">data</span><span class="p">[</span><span class="s">&#39;Type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">typeSel</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">SetStatusLine</span><span class="p">():</span>
        <span class="n">Status</span><span class="o">.</span><span class="n">SetStatusText</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="p">)</span>
                                      
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Destroy</span><span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetStatusBar</span><span class="p">():</span>
        <span class="n">Status</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">CreateStatusBar</span><span class="p">()</span>
    <span class="n">SetStatusLine</span><span class="p">()</span>
    <span class="n">zones</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;100&#39;</span><span class="p">,</span><span class="s">&#39;010&#39;</span><span class="p">,</span><span class="s">&#39;001&#39;</span><span class="p">]</span>
    <span class="n">HKLmax</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;HKLmax&#39;</span><span class="p">]</span>
    <span class="n">HKLmin</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;HKLmin&#39;</span><span class="p">]</span>
    <span class="n">typeChoices</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;Fosq&#39;</span><span class="p">,</span><span class="s">&#39;Fo&#39;</span><span class="p">,</span><span class="s">&#39;|DFsq|/sig&#39;</span><span class="p">,</span><span class="s">&#39;|DFsq|&gt;sig&#39;</span><span class="p">,</span><span class="s">&#39;|DFsq|&gt;3sig&#39;</span><span class="p">]</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Panel</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">)</span>
    <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&#39;HKL Plot Controls&#39;</span><span class="p">)</span>
    <span class="n">mainSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">VERTICAL</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>
    
    <span class="n">scaleSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
    <span class="n">scaleSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Scale&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
    <span class="n">scaleSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">maxValue</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span><span class="n">minValue</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">SL_HORIZONTAL</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="nb">int</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Scale&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">scaleSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scaleSel</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">scaleSel</span><span class="o">.</span><span class="n">SetLineSize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">scaleSel</span><span class="o">.</span><span class="n">SetPageSize</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
    <span class="n">scaleSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SLIDER</span><span class="p">,</span> <span class="n">OnScaleSlider</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">scaleSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>    
    
    <span class="n">zoneSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
    <span class="n">zoneSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Zone  &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">zoneSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Zone&#39;</span><span class="p">],</span><span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;100&#39;</span><span class="p">,</span><span class="s">&#39;010&#39;</span><span class="p">,</span><span class="s">&#39;001&#39;</span><span class="p">],</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_DROPDOWN</span><span class="p">)</span>
    <span class="n">zoneSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="n">OnSelZone</span><span class="p">)</span>
    <span class="n">zoneSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">zoneSel</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">zoneSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Plot type  &#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>        
    <span class="n">typeSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">ComboBox</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Type&#39;</span><span class="p">],</span><span class="n">choices</span><span class="o">=</span><span class="n">typeChoices</span><span class="p">,</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_READONLY</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">CB_DROPDOWN</span><span class="p">)</span>
    <span class="n">typeSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_COMBOBOX</span><span class="p">,</span> <span class="n">OnSelType</span><span class="p">)</span>
    <span class="n">zoneSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">typeSel</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">zoneSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>    
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">zoneSizer</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>    
        
    <span class="n">izone</span> <span class="o">=</span> <span class="n">zones</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;Zone&#39;</span><span class="p">])</span>
    <span class="n">layerSizer</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">BoxSizer</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">HORIZONTAL</span><span class="p">)</span>
    <span class="n">layerSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">StaticText</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">label</span><span class="o">=</span><span class="s">&#39; Layer&#39;</span><span class="p">),</span><span class="mi">0</span><span class="p">,</span>
        <span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="p">)</span>
    <span class="n">layerSel</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">Slider</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">,</span><span class="n">maxValue</span><span class="o">=</span><span class="n">HKLmax</span><span class="p">[</span><span class="n">izone</span><span class="p">],</span><span class="n">minValue</span><span class="o">=</span><span class="n">HKLmin</span><span class="p">[</span><span class="n">izone</span><span class="p">],</span>
        <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">SL_HORIZONTAL</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">SL_AUTOTICKS</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">SL_LABELS</span><span class="p">,</span><span class="n">value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">layerSel</span><span class="o">.</span><span class="n">SetLineSize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">layerSel</span><span class="o">.</span><span class="n">SetPageSize</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">layerSel</span><span class="o">.</span><span class="n">Bind</span><span class="p">(</span><span class="n">wx</span><span class="o">.</span><span class="n">EVT_SLIDER</span><span class="p">,</span> <span class="n">OnLayerSlider</span><span class="p">)</span>    
    <span class="n">layerSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">layerSel</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER_VERTICAL</span><span class="p">)</span>
    <span class="n">layerSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span><span class="mi">0</span><span class="p">)</span>    
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">layerSizer</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">RIGHT</span><span class="p">)</span>

        
    <span class="n">mainSizer</span><span class="o">.</span><span class="n">Layout</span><span class="p">()</span>    
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetSizer</span><span class="p">(</span><span class="n">mainSizer</span><span class="p">)</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">SetSize</span><span class="p">(</span><span class="n">mainSizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">))</span>
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">mainSizer</span><span class="o">.</span><span class="n">Fit</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">))</span>

<span class="c">################################################################################</span>
<span class="c">#####  Pattern tree routines</span>
<span class="c">################################################################################           </span>
       </div>
<div class="viewcode-block" id="GetPatternTreeDataNames"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.GetPatternTreeDataNames">[docs]</a><span class="k">def</span> <span class="nf">GetPatternTreeDataNames</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">dataTypes</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Not sure what this does</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">item</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">)</span>        
    <span class="k">while</span> <span class="n">item</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">name</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span> <span class="ow">in</span> <span class="n">dataTypes</span><span class="p">:</span>
            <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">item</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">names</span>
                          </div>
<div class="viewcode-block" id="GetPatternTreeItemId"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.GetPatternTreeItemId">[docs]</a><span class="k">def</span> <span class="nf">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span> <span class="n">parentId</span><span class="p">,</span> <span class="n">itemText</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Not sure what this does</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">item</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetFirstChild</span><span class="p">(</span><span class="n">parentId</span><span class="p">)</span>
    <span class="k">while</span> <span class="n">item</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">itemText</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">item</span>
        <span class="n">item</span><span class="p">,</span> <span class="n">cookie</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetNextChild</span><span class="p">(</span><span class="n">parentId</span><span class="p">,</span> <span class="n">cookie</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>                
</div>
<div class="viewcode-block" id="MovePatternTreeToGrid"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.MovePatternTreeToGrid">[docs]</a><span class="k">def</span> <span class="nf">MovePatternTreeToGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Not sure what this does</span>
<span class="sd">    &#39;&#39;&#39;</span>
    
<span class="c">#    print G2frame.PatternTree.GetItemText(item)</span>
    
    <span class="n">oldPage</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># will be set later if already on a Phase item</span>
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">:</span>
        <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;Comments&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()]</span>
                <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span> 
                <span class="n">Id</span> <span class="o">=</span> <span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;Comments&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Id</span><span class="p">:</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">Id</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>     <span class="c">#clumsy but avoids dead window problem when opening another project</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;Notebook&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetValue</span><span class="p">()]</span>
                <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span> 
                <span class="n">Id</span> <span class="o">=</span> <span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">,</span> <span class="s">&#39;Notebook&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">Id</span><span class="p">:</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">Id</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
            <span class="k">except</span><span class="p">:</span>     <span class="c">#clumsy but avoids dead window problem when opening another project</span>
                <span class="k">pass</span>
        <span class="k">elif</span> <span class="s">&#39;Phase Data for&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetLabel</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="p">:</span> 
                <span class="n">oldPage</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">dataDisplay</span><span class="o">.</span><span class="n">GetSelection</span><span class="p">()</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">Clear</span><span class="p">()</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetLabel</span><span class="p">(</span><span class="s">&#39;&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c">#create the frame for the data item window</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span> <span class="o">=</span> <span class="n">DataFrame</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">mainPanel</span><span class="p">,</span><span class="n">frame</span><span class="o">=</span><span class="n">G2frame</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">PhaseUserSize</span> <span class="o">=</span> <span class="bp">None</span>
        
    <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">Raise</span><span class="p">()</span>            
    <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">parentID</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">root</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPattern</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
    <span class="n">defWid</span> <span class="o">=</span> <span class="p">[</span><span class="mi">250</span><span class="p">,</span><span class="mi">150</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">item</span> <span class="o">!=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
        <span class="n">parentID</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">root</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="k">if</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Notebook&#39;</span><span class="p">:</span>
            <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">DataNotebookMenu</span><span class="p">)</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPattern</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">UpdateNotebook</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Controls&#39;</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPattern</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">False</span><span class="p">)</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>           <span class="c">#fill in defaults</span>
                <span class="n">data</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="c">#least squares controls</span>
                    <span class="s">&#39;deriv type&#39;</span><span class="p">:</span><span class="s">&#39;analytic Hessian&#39;</span><span class="p">,</span><span class="s">&#39;min dM/M&#39;</span><span class="p">:</span><span class="mf">0.0001</span><span class="p">,</span><span class="s">&#39;shift factor&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s">&#39;max cyc&#39;</span><span class="p">:</span><span class="mi">3</span><span class="p">}</span>
                <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>                             
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">Refine</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">SeqRefine</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">UpdateControls</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Sequential results&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">UpdateSeqResults</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>            
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Covariance&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">defWid</span><span class="p">)</span>
            <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">if</span> <span class="s">&#39;Rvals&#39;</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
                <span class="n">Nvars</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;varyList&#39;</span><span class="p">])</span>
                <span class="n">Rvals</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;Rvals&#39;</span><span class="p">]</span>
                <span class="n">text</span> <span class="o">=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Final residuals: </span><span class="se">\n</span><span class="s">Rw = </span><span class="si">%.3f%%</span><span class="s"> </span><span class="se">\n</span><span class="s">chi**2 = </span><span class="si">%.1f</span><span class="s"> </span><span class="se">\n</span><span class="s">GOF = </span><span class="si">%.2f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">Rvals</span><span class="p">[</span><span class="s">&#39;Rwp&#39;</span><span class="p">],</span><span class="n">Rvals</span><span class="p">[</span><span class="s">&#39;chisq&#39;</span><span class="p">],</span><span class="n">Rvals</span><span class="p">[</span><span class="s">&#39;GOF&#39;</span><span class="p">])</span>
                <span class="n">text</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">Nobs = </span><span class="si">%d</span><span class="s"> </span><span class="se">\n</span><span class="s">Nvals = </span><span class="si">%d</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">Rvals</span><span class="p">[</span><span class="s">&#39;Nobs&#39;</span><span class="p">],</span><span class="n">Nvars</span><span class="p">)</span>
                <span class="k">if</span> <span class="s">&#39;lamMax&#39;</span> <span class="ow">in</span> <span class="n">Rvals</span><span class="p">:</span>
                    <span class="n">text</span> <span class="o">+=</span> <span class="s">&#39;</span><span class="se">\n</span><span class="s">log10 MaxLambda = </span><span class="si">%.1f</span><span class="s">&#39;</span><span class="o">%</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">Rvals</span><span class="p">[</span><span class="s">&#39;lamMax&#39;</span><span class="p">]))</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetClientSize</span><span class="p">(),</span>
                <span class="n">value</span><span class="o">=</span><span class="s">&#39;See plot window for covariance display&#39;</span><span class="o">+</span><span class="n">text</span><span class="p">,</span><span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">TE_MULTILINE</span><span class="p">)</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotCovariance</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Constraints&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">G2cnstG</span><span class="o">.</span><span class="n">UpdateConstraints</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Rigid bodies&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">G2cnstG</span><span class="o">.</span><span class="n">UpdateRigidBodies</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Restraints&#39;</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="n">Phases</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">GetPhaseData</span><span class="p">()</span>
            <span class="n">phase</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="n">phaseName</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
            <span class="k">if</span> <span class="n">Phases</span><span class="p">:</span>
                <span class="n">phaseName</span> <span class="o">=</span> <span class="n">Phases</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">defWid</span><span class="p">)</span>
            <span class="n">G2restG</span><span class="o">.</span><span class="n">UpdateRestraints</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">Phases</span><span class="p">,</span><span class="n">phaseName</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&#39;IMG&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">Image</span> <span class="o">=</span> <span class="n">item</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotImage</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&#39;PKS&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPowderLines</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&#39;PWDR&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPattern</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">UpdatePWHKPlot</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="s">&#39;PWDR&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&#39;HKLF&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">Sngl</span> <span class="o">=</span> <span class="n">item</span>
            <span class="n">UpdatePWHKPlot</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="s">&#39;HKLF&#39;</span><span class="p">,</span><span class="n">item</span><span class="p">)</span>
        <span class="k">elif</span> <span class="s">&#39;PDF&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">item</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPDF</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;S(Q)&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Phases&#39;</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">setSizePosLeft</span><span class="p">(</span><span class="n">defWid</span><span class="p">)</span>
            <span class="n">wx</span><span class="o">.</span><span class="n">TextCtrl</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">GetClientSize</span><span class="p">(),</span>
                <span class="n">value</span><span class="o">=</span><span class="s">&#39;Select one phase to see its parameters&#39;</span><span class="p">)</span>            
    <span class="k">elif</span> <span class="s">&#39;I(Q)&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;I(Q)&#39;</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">&#39;S(Q)&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;S(Q)&#39;</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">&#39;F(Q)&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;F(Q)&#39;</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="s">&#39;G(R)&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;G(R)&#39;</span><span class="p">,</span><span class="n">newPlot</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>            
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">parentID</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Phases&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2phG</span><span class="o">.</span><span class="n">UpdatePhaseData</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">oldPage</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Comments&#39;</span><span class="p">:</span>
        <span class="n">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">DataCommentsMenu</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">UpdateComments</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Image Controls&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&#39;Image Controls&#39;</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">Image</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">masks</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span>
            <span class="n">GetPatternTreeItemId</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">G2frame</span><span class="o">.</span><span class="n">Image</span><span class="p">,</span> <span class="s">&#39;Masks&#39;</span><span class="p">))</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2imG</span><span class="o">.</span><span class="n">UpdateImageControls</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">masks</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotImage</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Masks&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&#39;Masks&#39;</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">Image</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2imG</span><span class="o">.</span><span class="n">UpdateMasks</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotImage</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Stress/Strain&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetTitle</span><span class="p">(</span><span class="s">&#39;Stress/Strain&#39;</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">Image</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2imG</span><span class="o">.</span><span class="n">UpdateStressStrain</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotImage</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;HKL Plot Controls&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">Sngl</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">UpdateHKLControls</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotSngl</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;PDF Controls&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPDF</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdatePDFGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;I(Q)&#39;</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;S(Q)&#39;</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;F(Q)&#39;</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotISFG</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="nb">type</span><span class="o">=</span><span class="s">&#39;G(R)&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Peak List&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPeakList</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdatePeakGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Background&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateBackground</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Limits&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateLimitsGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Instrument Parameters&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateInstrumentGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPeakWidths</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Sample Parameters&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>

        <span class="k">if</span> <span class="s">&#39;Temperature&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>           <span class="c">#temp fix for old gpx files</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;Scale&#39;</span><span class="p">:[</span><span class="mf">1.0</span><span class="p">,</span><span class="bp">True</span><span class="p">],</span><span class="s">&#39;Type&#39;</span><span class="p">:</span><span class="s">&#39;Debye-Scherrer&#39;</span><span class="p">,</span><span class="s">&#39;Absorption&#39;</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span><span class="bp">False</span><span class="p">],</span><span class="s">&#39;DisplaceX&#39;</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span><span class="bp">False</span><span class="p">],</span>
                <span class="s">&#39;DisplaceY&#39;</span><span class="p">:[</span><span class="mf">0.0</span><span class="p">,</span><span class="bp">False</span><span class="p">],</span><span class="s">&#39;Diffuse&#39;</span><span class="p">:[],</span><span class="s">&#39;Temperature&#39;</span><span class="p">:</span><span class="mf">300.</span><span class="p">,</span><span class="s">&#39;Pressure&#39;</span><span class="p">:</span><span class="mf">1.0</span><span class="p">,</span><span class="s">&#39;Humidity&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s">&#39;Voltage&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span>
                <span class="s">&#39;Force&#39;</span><span class="p">:</span><span class="mf">0.0</span><span class="p">,</span><span class="s">&#39;Gonio. radius&#39;</span><span class="p">:</span><span class="mf">200.0</span><span class="p">}</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
    
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateSampleGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Index Peak List&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">ExportPeakList</span><span class="p">:</span> <span class="n">i</span><span class="o">.</span><span class="n">Enable</span><span class="p">(</span><span class="bp">True</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateIndexPeaksGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;PKS&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span><span class="p">):</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPowderLines</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Unit Cells List&#39;</span><span class="p">:</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">data</span><span class="p">:</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mf">25.0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="s">&#39;P1&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">,</span><span class="mi">90</span><span class="p">])</span> <span class="c">#zero error flag, zero value, max Nc/No, start volume</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>      <span class="c">#Bravais lattice flags</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>                                 <span class="c">#empty cell list</span>
            <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>                                 <span class="c">#empty dmin</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">SetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>                             
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateUnitCellsGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;PKS&#39;</span> <span class="ow">in</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span><span class="p">):</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPowderLines</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Reflection Lists&#39;</span><span class="p">:</span>   <span class="c">#powder reflections</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PickId</span> <span class="o">=</span> <span class="n">item</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">RefList</span> <span class="o">=</span> <span class="s">&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">RefList</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateReflectionGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">)</span>
        <span class="n">G2plt</span><span class="o">.</span><span class="n">PlotPatterns</span><span class="p">(</span><span class="n">G2frame</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="o">==</span> <span class="s">&#39;Reflection List&#39;</span><span class="p">:</span>    <span class="c">#HKLF reflections</span>
        <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemParent</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemText</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">G2frame</span><span class="o">.</span><span class="n">PatternTree</span><span class="o">.</span><span class="n">GetItemPyData</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">PatternId</span><span class="p">)</span>
        <span class="n">G2pdG</span><span class="o">.</span><span class="n">UpdateReflectionGrid</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">data</span><span class="p">,</span><span class="n">HKLF</span><span class="o">=</span><span class="bp">True</span><span class="p">,</span><span class="n">Name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="SetDataMenuBar"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.SetDataMenuBar">[docs]</a><span class="k">def</span> <span class="nf">SetDataMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="p">,</span><span class="n">menu</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Set the menu for the data frame. On the Mac put this</span>
<span class="sd">    menu for the data tree window instead.</span>

<span class="sd">    Note that data frame items do not have menus, for these (menu=None)</span>
<span class="sd">    display a blank menu or on the Mac display the standard menu for</span>
<span class="sd">    the data tree window.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">platform</span> <span class="o">==</span> <span class="s">&quot;darwin&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">menu</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">GSASIIMenu</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">menu</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">BlankMenu</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">G2frame</span><span class="o">.</span><span class="n">dataFrame</span><span class="o">.</span><span class="n">SetMenuBar</span><span class="p">(</span><span class="n">menu</span><span class="p">)</span>
</div>
<div class="viewcode-block" id="HorizontalLine"><a class="viewcode-back" href="../GSASIIgrid.html#GSASIIgrid.HorizontalLine">[docs]</a><span class="k">def</span> <span class="nf">HorizontalLine</span><span class="p">(</span><span class="n">sizer</span><span class="p">,</span><span class="n">parent</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Draws a horizontal line as wide as the window.</span>
<span class="sd">    This shows up on the Mac as a very thin line, no matter what I do</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">line</span> <span class="o">=</span> <span class="n">wx</span><span class="o">.</span><span class="n">StaticLine</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">style</span><span class="o">=</span><span class="n">wx</span><span class="o">.</span><span class="n">LI_HORIZONTAL</span><span class="p">)</span>
    <span class="n">sizer</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="n">line</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">wx</span><span class="o">.</span><span class="n">EXPAND</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALIGN_CENTER</span><span class="o">|</span><span class="n">wx</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Von Dreele and Toby for Argonne National Laboratory.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>