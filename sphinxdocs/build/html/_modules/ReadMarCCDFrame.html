<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ReadMarCCDFrame &mdash; GSAS-II 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GSAS-II 0.2.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for ReadMarCCDFrame</h1><div class="highlight"><pre>
<span class="c">#!/usr/bin/env python</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">*ReadMarCCDFrame: Read Mar Files*</span>
<span class="sd">---------------------------------</span>

<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">&quot;&quot;&quot; </span>
<span class="sd">  from /opt/marccd/documentation/header.txt</span>

<span class="sd">   MarCCD Header Documentataion </span>

<span class="sd">   from C code in frame.h  and types.h</span>

<span class="sd">   Documentation updated by R. Doyle Mon Mar 22 15:04:00 CDT 2010</span>
<span class="sd">   Documentation updated by M. Blum Tue Oct 11 11:49:20 CDT 2005</span>

<span class="sd">   Description documents marccd v0.20.0</span>


<span class="sd">   Summary of file structure:</span>
<span class="sd">   |-- 1024 bytes TIFF HEADER -------------|</span>
<span class="sd">   |-- 3072 byte frame_header structure ---|</span>
<span class="sd">   |-- nfast*nslow*depth byte image -------|</span>

<span class="sd">   The full header, as written to the file, is a TIFF header.</span>
<span class="sd">   The initial 1024 bytes are a minimal TIFF header with a standard</span>
<span class="sd">   TIFF TAG pointing to the image data and a private TIFF TAG</span>
<span class="sd">   pointing to this header structure.  As written by mmx/marccd, the</span>
<span class="sd">   frame_header structure always begins at byte 1024 and is 3072 bytes long</span>
<span class="sd">   making the full header 4096 bytes.</span>

<span class="sd">   immediately following the header is the image - it is of arbitrary size defined</span>
<span class="sd">   by the header fields nfast, nslow and depth. The total size is</span>
<span class="sd">   nfast * nslow * depth bytes.</span>

<span class="sd">   The meanings of the data types should be self evident:</span>
<span class="sd">   (example:  UINT32 is an unsigned 32 bit integer)</span>
<span class="sd">   The exact C language definition is machine dependent but these</span>
<span class="sd">   are the most common definitions on a 32bit architecture cpu.</span>
<span class="sd">#define UINT16	unsigned short</span>
<span class="sd">#define INT16	short</span>
<span class="sd">#define UINT32	unsigned int</span>
<span class="sd">#define INT32	int</span>

<span class="sd">   Currently frames are always written as defined below:</span>
<span class="sd">	 origin=UPPER_LEFT</span>
<span class="sd">	 orientation=HFAST</span>
<span class="sd">	 view_direction=FROM_SOURCE</span>


<span class="sd">/* This number is  written into the byte_order fields in the</span>
<span class="sd">   native byte order of the machine writing the file */</span>
<span class="sd">#define LITTLE_ENDIAN	1234</span>
<span class="sd">#define BIG_ENDIAN	4321</span>

<span class="sd">/* possible orientations of frame data (stored in orienation field) */</span>
<span class="sd">#define HFAST			0	 /* Horizontal axis is fast */</span>
<span class="sd">#define VFAST			1	 /* Vertical axis is fast */</span>

<span class="sd">/* possible origins of frame data (stored in origin field) */</span>
<span class="sd">#define UPPER_LEFT		0</span>
<span class="sd">#define LOWER_LEFT		1</span>
<span class="sd">#define UPPER_RIGHT		2</span>
<span class="sd">#define LOWER_RIGHT		3</span>

<span class="sd">/* possible view directions of frame data for</span>
<span class="sd">   the given orientation and origin (stored in view_direction field) */</span>
<span class="sd">#define FROM_SOURCE		0</span>
<span class="sd">#define TOWARD_SOURCE		1</span>

<span class="sd">/* possible types of data (in data_type field) */</span>
<span class="sd">#define DATA_UNSIGNED_INTEGER   0</span>
<span class="sd">#define DATA_SIGNED_INTEGER     1</span>
<span class="sd">#define DATA_FLOAT              2</span>

<span class="sd">#define MAXIMAGES 9</span>
<span class="sd">#define MAXSUBIMAGES 4096</span>
<span class="sd">#define MAXFRAMEDIMENSION       8192</span>

<span class="sd">typedef struct frame_header_type {</span>
<span class="sd">	/* File/header format parameters (256 bytes) */</span>
<span class="sd">	UINT32        header_type;	/* flag for header type  (can be used as magic number) */</span>
<span class="sd">	char header_name[16];		/* header name (MARCCD) */</span>
<span class="sd">	UINT32        header_major_version;	/* header_major_version (n.) */</span>
<span class="sd">	UINT32        header_minor_version; 	/* header_minor_version (.n) */</span>
<span class="sd">	UINT32        header_byte_order;/* BIG_ENDIAN (Motorola,MIPS); LITTLE_ENDIAN (DEC, Intel) */</span>
<span class="sd">	UINT32        data_byte_order;	/* BIG_ENDIAN (Motorola,MIPS); LITTLE_ENDIAN (DEC, Intel) */</span>
<span class="sd">	UINT32        header_size;	/* in bytes			*/</span>
<span class="sd">	UINT32        frame_type;	/* flag for frame type */</span>
<span class="sd">	UINT32        magic_number;	/* to be used as a flag - usually to indicate new file */</span>
<span class="sd">	UINT32        compression_type;	/* type of image compression    */</span>
<span class="sd">	UINT32        compression1;	/* compression parameter 1 */</span>
<span class="sd">	UINT32        compression2;	/* compression parameter 2 */</span>
<span class="sd">	UINT32        compression3;	/* compression parameter 3 */</span>
<span class="sd">	UINT32        compression4;	/* compression parameter 4 */</span>
<span class="sd">	UINT32        compression5;	/* compression parameter 4 */</span>
<span class="sd">	UINT32        compression6;	/* compression parameter 4 */</span>
<span class="sd">	UINT32        nheaders;	        /* total number of headers 	*/</span>
<span class="sd"> 	UINT32        nfast;		/* number of pixels in one line */</span>
<span class="sd"> 	UINT32        nslow;		/* number of lines in image     */</span>
<span class="sd"> 	UINT32        depth;		/* number of bytes per pixel    */</span>
<span class="sd"> 	UINT32        record_length;	/* number of pixels between succesive rows */</span>
<span class="sd"> 	UINT32        signif_bits;	/* true depth of data, in bits  */</span>
<span class="sd"> 	UINT32        data_type;	/* (signed,unsigned,float...) */</span>
<span class="sd"> 	UINT32        saturated_value;	/* value marks pixel as saturated */</span>
<span class="sd">	UINT32        sequence;	        /* TRUE or FALSE */</span>
<span class="sd">	UINT32        nimages;	        /* total number of images - size of each is nfast*(nslow/nimages) */</span>
<span class="sd"> 	UINT32        origin;		/* corner of origin 		*/</span>
<span class="sd"> 	UINT32        orientation;	/* direction of fast axis 	*/</span>
<span class="sd">        UINT32        view_direction;   /* direction to view frame      */</span>
<span class="sd">	UINT32        overflow_location;/* FOLLOWING_HEADER, FOLLOWING_DATA */</span>
<span class="sd">	UINT32        over_8_bits;	/* # of pixels with counts &gt; 255 */</span>
<span class="sd">	UINT32        over_16_bits;	/* # of pixels with count &gt; 65535 */</span>
<span class="sd">	UINT32        multiplexed;	/* multiplex flag */</span>
<span class="sd">	UINT32        nfastimages;	/* # of images in fast direction */</span>
<span class="sd">	UINT32        nslowimages;	/* # of images in slow direction */</span>
<span class="sd">	UINT32        darkcurrent_applied; /* flags correction has been applied - hold magic number ? */</span>
<span class="sd">	UINT32        bias_applied;	  /* flags correction has been applied - hold magic number ? */</span>
<span class="sd">	UINT32        flatfield_applied;  /* flags correction has been applied - hold magic number ? */</span>
<span class="sd">	UINT32        distortion_applied; /* flags correction has been applied - hold magic number ? */</span>
<span class="sd">	UINT32        original_header_type;	/* Header/frame type from file that frame is read from */</span>
<span class="sd">	UINT32        file_saved;         /* Flag that file has been saved, should be zeroed if modified */</span>
<span class="sd">	UINT32        n_valid_pixels;     /* Number of pixels holding valid data - first N pixels */</span>
<span class="sd">	UINT32        defectmap_applied; /* flags correction has been applied - hold magic number ? */</span>
<span class="sd">	UINT32        subimage_nfast; 	    /* when divided into subimages (eg. frameshifted) */</span>
<span class="sd">	UINT32        subimage_nslow;       /* when divided into subimages (eg. frameshifted) */</span>
<span class="sd">	UINT32        subimage_origin_fast; /* when divided into subimages (eg. frameshifted) */</span>
<span class="sd">	UINT32        subimage_origin_slow; /* when divided into subimages (eg. frameshifted) */</span>
<span class="sd">	UINT32        readout_pattern;      /* BIT Code - 1 = A, 2 = B, 4 = C, 8 = D */</span>
<span class="sd"> 	UINT32        saturation_level;	    /* at this value and above, data are not reliable */</span>
<span class="sd"> 	UINT32        orientation_code;	    /* Describes how this frame needs to be rotated to make it &quot;right&quot; */</span>
<span class="sd"> 	UINT32        frameshift_multiplexed;  /* frameshift multiplex flag */</span>
<span class="sd">	UINT32        prescan_nfast;            /* Number of non-image pixels preceeding imaging pixels - fast direction */</span>
<span class="sd">	UINT32        prescan_nslow;            /* Number of non-image pixels preceeding imaging pixels - slow direction */</span>
<span class="sd">	UINT32        postscan_nfast;           /* Number of non-image pixels followng imaging pixels - fast direction */</span>
<span class="sd">	UINT32        postscan_nslow;           /* Number of non-image pixels followng imaging pixels - slow direction */</span>
<span class="sd">	UINT32        prepost_trimmed;          /* trimmed==1 means pre and post scan pixels have been removed */</span>
<span class="sd">	char reserve1[(64-55)*sizeof(INT32)-16];</span>

<span class="sd">	/* Data statistics (128) */</span>
<span class="sd">	UINT32        total_counts[2];	/* 64 bit integer range = 1.85E19*/</span>
<span class="sd">	UINT32        special_counts1[2];</span>
<span class="sd">	UINT32        special_counts2[2];</span>
<span class="sd">	UINT32        min;</span>
<span class="sd">	UINT32        max;</span>
<span class="sd">	INT32        mean;			/* mean * 1000 */</span>
<span class="sd">	UINT32        rms;			/* rms * 1000 */</span>
<span class="sd">	UINT32        n_zeros;			/* number of pixels with 0 value  - not included in stats in unsigned data */</span>
<span class="sd">	UINT32        n_saturated;		/* number of pixels with saturated value - not included in stats */</span>
<span class="sd">	UINT32        stats_uptodate;		/* Flag that stats OK - ie data not changed since last calculation */</span>
<span class="sd">        UINT32        pixel_noise[MAXIMAGES];		/* 1000*base noise value (ADUs) */</span>
<span class="sd">	char reserve2[(32-13-MAXIMAGES)*sizeof(INT32)];</span>

<span class="sd">	/* Sample Changer info */</span>
<span class="sd">	char          barcode[16];</span>
<span class="sd">	UINT32        barcode_angle;</span>
<span class="sd">	UINT32        barcode_status;</span>
<span class="sd">	/* Pad to 256 bytes */</span>
<span class="sd">	char reserve2a[(64-6)*sizeof(INT32)];</span>

<span class="sd">	/* Goniostat parameters (128 bytes) */</span>
<span class="sd">        INT32 xtal_to_detector;		/* 1000*distance in millimeters */</span>
<span class="sd">        INT32 beam_x;			/* 1000*x beam position (pixels) */</span>
<span class="sd">        INT32 beam_y;			/* 1000*y beam position (pixels) */</span>
<span class="sd">        INT32 integration_time;		/* integration time in milliseconds */</span>
<span class="sd">        INT32 exposure_time;		/* exposure time in milliseconds */</span>
<span class="sd">        INT32 readout_time;		/* readout time in milliseconds */</span>
<span class="sd">        INT32 nreads;			/* number of readouts to get this image */</span>
<span class="sd">        INT32 start_twotheta;		/* 1000*two_theta angle */</span>
<span class="sd">        INT32 start_omega;		/* 1000*omega angle */</span>
<span class="sd">        INT32 start_chi;			/* 1000*chi angle */</span>
<span class="sd">        INT32 start_kappa;		/* 1000*kappa angle */</span>
<span class="sd">        INT32 start_phi;			/* 1000*phi angle */</span>
<span class="sd">        INT32 start_delta;		/* 1000*delta angle */</span>
<span class="sd">        INT32 start_gamma;		/* 1000*gamma angle */</span>
<span class="sd">        INT32 start_xtal_to_detector;	/* 1000*distance in mm (dist in um)*/</span>
<span class="sd">        INT32 end_twotheta;		/* 1000*two_theta angle */</span>
<span class="sd">        INT32 end_omega;			/* 1000*omega angle */</span>
<span class="sd">        INT32 end_chi;			/* 1000*chi angle */</span>
<span class="sd">        INT32 end_kappa;			/* 1000*kappa angle */</span>
<span class="sd">        INT32 end_phi;			/* 1000*phi angle */</span>
<span class="sd">        INT32 end_delta;			/* 1000*delta angle */</span>
<span class="sd">        INT32 end_gamma;			/* 1000*gamma angle */</span>
<span class="sd">        INT32 end_xtal_to_detector;	/* 1000*distance in mm (dist in um)*/</span>
<span class="sd">        INT32 rotation_axis;		/* active rotation axis (index into above ie. 0=twotheta,1=omega...) */</span>
<span class="sd">        INT32 rotation_range;		/* 1000*rotation angle */</span>
<span class="sd">        INT32 detector_rotx;		/* 1000*rotation of detector around X */</span>
<span class="sd">        INT32 detector_roty;		/* 1000*rotation of detector around Y */</span>
<span class="sd">        INT32 detector_rotz;		/* 1000*rotation of detector around Z */</span>
<span class="sd">        INT32 total_dose;		/* Hz-sec (counts) integrated over full exposure */</span>
<span class="sd">	char reserve3[(32-29)*sizeof(INT32)]; /* Pad Gonisotat parameters to 128 bytes */</span>

<span class="sd">	/* Detector parameters (128 bytes) */</span>
<span class="sd">	INT32 detector_type;		/* detector type */</span>
<span class="sd">	INT32 pixelsize_x;		/* pixel size (nanometers) */</span>
<span class="sd">	INT32 pixelsize_y;		/* pixel size (nanometers) */</span>
<span class="sd">        INT32 mean_bias;			/* 1000*mean bias value */</span>
<span class="sd">        INT32 photons_per_100adu;	/* photons / 100 ADUs */</span>
<span class="sd">        INT32 measured_bias[MAXIMAGES];	/* 1000*mean bias value for each image*/</span>
<span class="sd">        INT32 measured_temperature[MAXIMAGES];	/* Temperature of each detector in milliKelvins */</span>
<span class="sd">        INT32 measured_pressure[MAXIMAGES];	/* Pressure of each chamber in microTorr */</span>
<span class="sd">	/* Retired reserve4 when MAXIMAGES set to 9 from 16 and two fields removed, and temp and pressure added</span>
<span class="sd">	char reserve4[(32-(5+3*MAXIMAGES))*sizeof(INT32)];</span>
<span class="sd">	*/</span>

<span class="sd">	/* X-ray source and optics parameters (128 bytes) */</span>
<span class="sd">	/* X-ray source parameters (14*4 bytes) */</span>
<span class="sd">        INT32 source_type;		/* (code) - target, synch. etc */</span>
<span class="sd">        INT32 source_dx;			/* Optics param. - (size microns) */</span>
<span class="sd">        INT32 source_dy;			/* Optics param. - (size microns) */</span>
<span class="sd">        INT32 source_wavelength;		/* wavelength (femtoMeters) */</span>
<span class="sd">        INT32 source_power;		/* (Watts) */</span>
<span class="sd">        INT32 source_voltage;		/* (Volts) */</span>
<span class="sd">        INT32 source_current;		/* (microAmps) */</span>
<span class="sd">        INT32 source_bias;		/* (Volts) */</span>
<span class="sd">        INT32 source_polarization_x;	/* () */</span>
<span class="sd">        INT32 source_polarization_y;	/* () */</span>
<span class="sd">        INT32 source_intensity_0;	/* (arbitrary units) */</span>
<span class="sd">        INT32 source_intensity_1;	/* (arbitrary units) */</span>
<span class="sd">	char reserve_source[2*sizeof(INT32)];</span>

<span class="sd">	/* X-ray optics_parameters (8*4 bytes) */</span>
<span class="sd">        INT32 optics_type;		/* Optics type (code)*/</span>
<span class="sd">        INT32 optics_dx;			/* Optics param. - (size microns) */</span>
<span class="sd">        INT32 optics_dy;			/* Optics param. - (size microns) */</span>
<span class="sd">        INT32 optics_wavelength;		/* Optics param. - (size microns) */</span>
<span class="sd">        INT32 optics_dispersion;		/* Optics param. - (*10E6) */</span>
<span class="sd">        INT32 optics_crossfire_x;	/* Optics param. - (microRadians) */</span>
<span class="sd">        INT32 optics_crossfire_y;	/* Optics param. - (microRadians) */</span>
<span class="sd">        INT32 optics_angle;		/* Optics param. - (monoch. 2theta - microradians) */</span>
<span class="sd">        INT32 optics_polarization_x;	/* () */</span>
<span class="sd">        INT32 optics_polarization_y;	/* () */</span>
<span class="sd">	char reserve_optics[4*sizeof(INT32)];</span>

<span class="sd">	char reserve5[((32-28)*sizeof(INT32))]; /* Pad X-ray parameters to 128 bytes */</span>

<span class="sd">	/* File parameters (1024 bytes) */</span>
<span class="sd">	char filetitle[128];		/* Title 				*/</span>
<span class="sd">	char filepath[128];		/* path name for data file		*/</span>
<span class="sd">	char filename[64];		/* name of data file			*/</span>
<span class="sd">        char acquire_timestamp[32];	/* date and time of acquisition		*/</span>
<span class="sd">        char header_timestamp[32];	/* date and time of header update	*/</span>
<span class="sd">        char save_timestamp[32];	/* date and time file saved 		*/</span>
<span class="sd">        char file_comment[512];	/* comments  - can be used as desired 	*/</span>
<span class="sd">	char reserve6[1024-(128+128+64+(3*32)+512)]; /* Pad File parameters to 1024 bytes */</span>

<span class="sd">	/* Dataset parameters (512 bytes) */</span>
<span class="sd">        char dataset_comment[512];	/* comments  - can be used as desired 	*/</span>

<span class="sd">	/* Reserved for user definable data - will not be used by Mar! */</span>
<span class="sd">	char user_data[512];</span>

<span class="sd">	/* char pad[----] USED UP! */     /* pad out to 3072 bytes */</span>

<span class="sd">	} frame_header;</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">struct</span> <span class="kn">as</span> <span class="nn">st</span>
<span class="kn">import</span> <span class="nn">array</span> <span class="kn">as</span> <span class="nn">ar</span>
<span class="kn">import</span> <span class="nn">string</span><span class="o">,</span> <span class="nn">re</span>

<span class="n">MAXIMAGES</span><span class="o">=</span><span class="mi">9</span>

<div class="viewcode-block" id="marFrame"><a class="viewcode-back" href="../GSASIIGUIr.html#ReadMarCCDFrame.marFrame">[docs]</a><span class="k">class</span> <span class="nc">marFrame</span><span class="p">():</span>
    <span class="sd">&#39;&#39;&#39;A class to extract correct mar header and image info from a MarCCD file</span>

<span class="sd">    :param str File: file object [from open()]</span>
<span class="sd">    :param byteOrd: &#39;&lt;&#39; (default) or &#39;&gt;&#39;  </span>
<span class="sd">    :param dict IFD: ?</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">File</span><span class="p">,</span><span class="n">byteOrd</span><span class="o">=</span><span class="s">&#39;&lt;&#39;</span><span class="p">,</span><span class="n">IFD</span><span class="o">=</span><span class="p">{}):</span>
        <span class="c"># simple TIFF header info</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFsizeX</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">256</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFsizeY</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">257</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFbitDepth</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">258</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFcompression</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">259</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># 1 = no compression</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFphotometricInterpretation</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">262</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># 1 = bilevel or grayscale where 0 is imaged as black</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFstripOffsets</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">273</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># seems to be 4096 for marCCD</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFForientation</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">274</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># 1 = 0th row it top, 0th column is left</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFrowsPerStrip</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">278</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># varies based on image size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFstripByteCounts</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">279</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># number of bytes in a strip also varies based on size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFxResolution</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">282</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># pixels per resolutionUnit in X direction (ImageWidth direction)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFyResolution</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">283</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># pixels per resolutionUnit in Y direction (ImageLength direction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">TIFFresolutionUnit</span> <span class="o">=</span> <span class="n">IFD</span><span class="p">[</span><span class="mi">296</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c"># 3 = centimeter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">byteDepth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">TIFFbitDepth</span><span class="o">/</span><span class="mi">8</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">arrayTypeCode</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="s">&#39;B&#39;</span><span class="p">,</span><span class="s">&#39;H&#39;</span><span class="p">,</span><span class="s">&#39;L&#39;</span><span class="p">][</span><span class="bp">self</span><span class="o">.</span><span class="n">byteDepth</span><span class="p">]</span>
        <span class="c"># MarCCD specific header info</span>
        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flag for header type  (can be used as magic number) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerName</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerMajorVersion</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* header_major_version (n.) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerMinorVersion</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* header_minor_version (.n) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerByteOrder</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* BIG_ENDIAN (Motorola,MIPS); LITTLE_ENDIAN (DEC, Intel) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataByteOrder</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* BIG_ENDIAN (Motorola,MIPS); LITTLE_ENDIAN (DEC, Intel) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerSize</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* in bytes			*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frameType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flag for frame type */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">magicNumber</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* to be used as a flag - usually to indicate new file */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compressionType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* type of image compression    */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression1</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 1 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 2 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression3</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 3 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression4</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 4 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression5</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 4 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">compression6</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* compression parameter 4 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nheaders</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* total number of headers 	*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfast</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of pixels in one line */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nslow</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of lines in image     */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depth</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of bytes per pixel    */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recordLength</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of pixels between succesive rows */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">signifBits</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* true depth of data, in bits  */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dataType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (signed,unsigned,float...) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saturatedValue</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* value marks pixel as saturated */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sequence</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* TRUE or FALSE */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nimages</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* total number of images - size of each is nfast*(nslow/nimages) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">origin</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* corner of origin 		*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientation</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* direction of fast axis 	*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewDirection</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* direction to view frame      */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">overflowLocation</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* FOLLOWING_HEADER, FOLLOWING_DATA */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">over8Bits</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* # of pixels with counts &gt; 255 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">over16Bits</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* # of pixels with count &gt; 65535 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">multiplexed</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* multiplex flag */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nfastimages</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* # of images in fast direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nslowimages</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* # of images in slow direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">darkcurrentApplied</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flags correction has been applied - hold magic number ? */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">biasApplied</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flags correction has been applied - hold magic number ? */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flatfieldApplied</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flags correction has been applied - hold magic number ? */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">distortionApplied</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flags correction has been applied - hold magic number ? */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">originalHeaderType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Header/frame type from file that frame is read from */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileSaved</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Flag that file has been saved, should be zeroed if modified */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nValidPixels</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Number of pixels holding valid data - first N pixels */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defectmapApplied</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* flags correction has been applied - hold magic number ? */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subimageNfast</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* when divided into subimages (eg. frameshifted) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subimageNslow</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* when divided into subimages (eg. frameshifted) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subimageOriginFast</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* when divided into subimages (eg. frameshifted) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subimageOriginSlow</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* when divided into subimages (eg. frameshifted) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readoutPattern</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* BIT Code - 1 = A, 2 = B, 4 = C, 8 = D */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saturationLevel</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* at this value and above, data are not reliable */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">orientationCode</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Describes how this frame needs to be rotated to make it &quot;right&quot; */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frameshiftMultiplexed</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* frameshift multiplex flag */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prescanNfast</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Number of non-image pixels preceeding imaging pixels - fast direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prescanNslow</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Number of non-image pixels preceeding imaging pixels - slow direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postscanNfast</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Number of non-image pixels followng imaging pixels - fast direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">postscanNslow</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Number of non-image pixels followng imaging pixels - slow direction */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prepostTrimmed</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* trimmed==1 means pre and post scan pixels have been removed */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="c">#self.totalCounts = st.unpack(byteOrd+&#39;Q&#39;,File.read(8))[0] # /* 64 bit integer range = 1.85E19*/</span>
        <span class="c">#self.specialCounts1 = st.unpack(byteOrd+&#39;Q&#39;,File.read(8))[0]</span>
        <span class="c">#self.specialCounts2 = st.unpack(byteOrd+&#39;Q&#39;,File.read(8))[0]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalCounts</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;II&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specialCounts1</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;II&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">specialCounts2</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;II&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">8</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">min</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c"># /* mean * 1000 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rms</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* rms * 1000 */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nZeros</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of pixels with 0 value  - not included in stats in unsigned data */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nSaturated</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of pixels with saturated value - not included in stats */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">statsUptodate</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Flag that stats OK - ie data not changed since last calculation */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixelNoise</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">))</span> <span class="c"># /* 1000*base noise value (ADUs) */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barcode</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="mi">16</span><span class="o">*</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">16</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barcodeAngle</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">barcodeStatus</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;I&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">256</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">xtalToDetector</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*distance in millimeters */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beamX</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*x beam position (pixels) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">beamY</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*y beam position (pixels) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">integrationTime</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* integration time in milliseconds */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exposureTime</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* exposure time in milliseconds */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">readoutTime</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* readout time in milliseconds */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nreads</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* number of readouts to get this image */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startTwotheta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*two_theta angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startOmega</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*omega angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startChi</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*chi angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startKappa</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*kappa angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startPhi</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*phi angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startDelta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*delta angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startGamma</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*gamma angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">startXtalToDetector</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*distance in mm (dist in um)*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endTwotheta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*two_theta angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endOmega</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*omega angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endChi</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*chi angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endKappa</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*kappa angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endPhi</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*phi angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endDelta</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*delta angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endGamma</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*gamma angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">endXtalToDetector</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*distance in mm (dist in um)*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotationAxis</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* active rotation axis (index into above ie. 0=twotheta,1=omega...) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rotationRange</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*rotation angle */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectorRotx</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*rotation of detector around X */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectorRoty</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*rotation of detector around Y */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectorRotz</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*rotation of detector around Z */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">totalDose</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Hz-sec (counts) integrated over full exposure */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">detectorType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* detector type */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixelsizeX</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* pixel size (nanometers) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pixelsizeY</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* pixel size (nanometers) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">meanBias</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* 1000*mean bias value */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">photonsPer100adu</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* photons / 100 ADUs */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredBias</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">))</span> <span class="c"># /* 1000*mean bias value for each image*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredTemperature</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">))</span> <span class="c"># /* Temperature of each detector in milliKelvins */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">measuredPressure</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="o">*</span><span class="n">MAXIMAGES</span><span class="p">))</span> <span class="c"># /* Pressure of each chamber in microTorr */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (code) - target, synch. etc */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceDx</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (size microns) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceDy</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (size microns) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceWavelength</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* wavelength (femtoMeters) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourcePower</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (Watts) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceVoltage</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (Volts) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceCurrent</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (microAmps) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceBias</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (Volts) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourcePolarizationX</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* () */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourcePolarizationY</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* () */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceIntensity0</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (arbitrary units) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sourceIntensity1</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* (arbitrary units) */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">14</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsType</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics type (code)*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsDx</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (size microns) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsDy</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (size microns) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsWavelength</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (size microns) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsDispersion</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (*10E6) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsCrossfireX</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (microRadians) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsCrossfireY</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (microRadians) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsAngle</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* Optics param. - (monoch. 2theta - microradians) */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsPolarizationX</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* () */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">opticsPolarizationY</span> <span class="o">=</span> <span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;i&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="c">#/* () */</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="n">IFD</span><span class="p">[</span><span class="mi">34710</span><span class="p">][</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">256</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">128</span><span class="o">+</span><span class="mi">128</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filetitle</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="mi">128</span><span class="o">*</span><span class="s">&#39;c&#39;</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">128</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">128</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">128</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* path name for data file*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">filename</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">64</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">64</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* name of data file*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">acquireTimestamp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">32</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* date and time of acquisition*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">headerTimestamp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">32</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* date and time of header update*/</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">saveTimestamp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">32</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* date and time file saved */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fileComment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">512</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">512</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* comments  - can be used as desired */</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">datasetComment</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">512</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">512</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span> <span class="c">#/* comments  - can be used as desired */</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">userData</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s">r&#39;\x00&#39;</span><span class="p">,</span><span class="s">&#39;&#39;</span><span class="p">,</span><span class="n">string</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">st</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="n">byteOrd</span><span class="o">+</span><span class="s">&#39;c&#39;</span><span class="o">*</span><span class="mi">512</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">512</span><span class="p">)),</span><span class="s">&#39;&#39;</span><span class="p">))</span>

        <span class="n">File</span><span class="o">.</span><span class="n">seek</span><span class="p">(</span><span class="mi">4096</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span> <span class="o">=</span> <span class="n">ar</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">arrayTypeCode</span><span class="p">,</span><span class="n">File</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">byteDepth</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">TIFFsizeX</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">TIFFsizeY</span><span class="p">))</span>
    <span class="c"># reverse the array so if can have the same view as is read in marccd</span>
    <span class="c"># also switch the view direction </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">image</span><span class="o">.</span><span class="n">reverse</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">viewDirection</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">viewDirection</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">outputHead</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">myHead</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">curAttr</span> <span class="ow">in</span> <span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">if</span> <span class="p">(</span> <span class="n">curAttr</span> <span class="o">!=</span> <span class="s">&#39;__doc__&#39;</span> <span class="ow">and</span> \
                 <span class="n">curAttr</span> <span class="o">!=</span> <span class="s">&#39;__init__&#39;</span> <span class="ow">and</span> \
                 <span class="n">curAttr</span> <span class="o">!=</span> <span class="s">&#39;__module__&#39;</span> <span class="ow">and</span> \
                 <span class="n">curAttr</span> <span class="o">!=</span> <span class="s">&#39;outputHead&#39;</span> <span class="ow">and</span> \
                 <span class="n">curAttr</span> <span class="o">!=</span> <span class="s">&#39;image&#39;</span> <span class="p">):</span>
                <span class="n">myHead</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s">&quot; </span><span class="si">%s</span><span class="s"> = </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">curAttr</span><span class="p">,</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">curAttr</span><span class="p">)))</span>
        <span class="k">return</span> <span class="n">myHead</span></div>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/G2_html_logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Von Dreele and Toby for Argonne National Laboratory.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>