<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>GSASIIElem &mdash; GSAS-II 0.2.0 documentation</title>
    
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="GSAS-II 0.2.0 documentation" href="../index.html" />
    <link rel="up" title="Module code" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" accesskey="U">Module code</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <h1>Source code for GSASIIElem</h1><div class="highlight"><pre>
<span class="c"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">*GSASIIElem: functions for element types*</span>
<span class="sd">-----------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="c"># Copyright: 2008, Robert B. Von Dreele &amp; Brian H. Toby (Argonne National Laboratory)</span>
<span class="c">########### SVN repository information ###################</span>
<span class="c"># $Date: 2014-08-01 15:19:48 -0500 (Fri, 01 Aug 2014) $</span>
<span class="c"># $Author: vondreele $</span>
<span class="c"># $Revision: 1453 $</span>
<span class="c"># $URL: https://subversion.xor.aps.anl.gov/pyGSAS/trunk/GSASIIElem.py $</span>
<span class="c"># $Id: GSASIIElem.py 1453 2014-08-01 20:19:48Z vondreele $</span>
<span class="c">########### SVN repository information ###################</span>

<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">GSASIIpath</span>
<span class="n">GSASIIpath</span><span class="o">.</span><span class="n">SetVersionNumber</span><span class="p">(</span><span class="s">&quot;$Revision: 1453 $&quot;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">atmdata</span>

<span class="n">getElSym</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">sym</span><span class="p">:</span> <span class="n">sym</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;+&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span>
<div class="viewcode-block" id="GetFormFactorCoeff"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetFormFactorCoeff">[docs]</a><span class="k">def</span> <span class="nf">GetFormFactorCoeff</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read X-ray form factor coefficients from `atomdata.py` file</span>

<span class="sd">    :param str El: element 1-2 character symbol, case irrevelant</span>
<span class="sd">    :return: `FormFactors`: list of form factor dictionaries</span>
<span class="sd">    </span>
<span class="sd">    Each X-ray form factor dictionary is:</span>
<span class="sd">    </span>
<span class="sd">    * `Symbol`: 4 character element symbol with valence (e.g. &#39;NI+2&#39;)</span>
<span class="sd">    * `Z`: atomic number</span>
<span class="sd">    * `fa`: 4 A coefficients</span>
<span class="sd">    * `fb`: 4 B coefficients</span>
<span class="sd">    * `fc`: C coefficient</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    
    <span class="n">Els</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
    <span class="n">valences</span> <span class="o">=</span> <span class="p">[</span><span class="n">ky</span> <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">XrayFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">Els</span> <span class="o">==</span> <span class="n">getElSym</span><span class="p">(</span><span class="n">ky</span><span class="p">)]</span>
    <span class="n">FormFactors</span> <span class="o">=</span> <span class="p">[</span><span class="n">atmdata</span><span class="o">.</span><span class="n">XrayFF</span><span class="p">[</span><span class="n">val</span><span class="p">]</span> <span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">valences</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">Sy</span><span class="p">,</span><span class="n">FF</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">valences</span><span class="p">,</span><span class="n">FormFactors</span><span class="p">):</span>
        <span class="n">FF</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s">&#39;Symbol&#39;</span><span class="p">:</span><span class="n">Sy</span><span class="o">.</span><span class="n">upper</span><span class="p">()})</span>
    <span class="k">return</span> <span class="n">FormFactors</span>
    </div>
<div class="viewcode-block" id="GetFFtable"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetFFtable">[docs]</a><span class="k">def</span> <span class="nf">GetFFtable</span><span class="p">(</span><span class="n">atomTypes</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; returns a dictionary of form factor data for atom types found in atomTypes</span>

<span class="sd">    :param list atomTypes: list of atom types</span>
<span class="sd">    :return: FFtable, dictionary of form factor data; key is atom type</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">FFtable</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">atomTypes</span><span class="p">:</span>
        <span class="n">FFs</span> <span class="o">=</span> <span class="n">GetFormFactorCoeff</span><span class="p">(</span><span class="n">getElSym</span><span class="p">(</span><span class="n">El</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">FFs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">item</span><span class="p">[</span><span class="s">&#39;Symbol&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">El</span><span class="o">.</span><span class="n">upper</span><span class="p">():</span>
                <span class="n">FFtable</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>
    <span class="k">return</span> <span class="n">FFtable</span>
    </div>
<div class="viewcode-block" id="GetBLtable"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetBLtable">[docs]</a><span class="k">def</span> <span class="nf">GetBLtable</span><span class="p">(</span><span class="n">General</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39; returns a dictionary of neutron scattering length data for atom types &amp; isotopes found in General</span>

<span class="sd">    :param dict General: dictionary of phase info.; includes AtomTypes &amp; Isotopes</span>
<span class="sd">    :return: BLtable, dictionary of scattering length data; key is atom type</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">atomTypes</span> <span class="o">=</span> <span class="n">General</span><span class="p">[</span><span class="s">&#39;AtomTypes&#39;</span><span class="p">]</span>
    <span class="n">BLtable</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">isotope</span> <span class="o">=</span> <span class="n">General</span><span class="p">[</span><span class="s">&#39;Isotope&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">atomTypes</span><span class="p">:</span>
        <span class="n">ElS</span> <span class="o">=</span> <span class="n">getElSym</span><span class="p">(</span><span class="n">El</span><span class="p">)</span>
        <span class="k">if</span> <span class="s">&#39;Nat&#39;</span> <span class="ow">in</span> <span class="n">isotope</span><span class="p">[</span><span class="n">El</span><span class="p">]:</span>
            <span class="n">BLtable</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">isotope</span><span class="p">[</span><span class="n">El</span><span class="p">],</span><span class="n">atmdata</span><span class="o">.</span><span class="n">AtmBlens</span><span class="p">[</span><span class="n">ElS</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="p">]]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">BLtable</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">isotope</span><span class="p">[</span><span class="n">El</span><span class="p">],</span><span class="n">atmdata</span><span class="o">.</span><span class="n">AtmBlens</span><span class="p">[</span><span class="n">ElS</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="o">+</span><span class="n">isotope</span><span class="p">[</span><span class="n">El</span><span class="p">]]]</span>
    <span class="k">return</span> <span class="n">BLtable</span>
        </div>
<div class="viewcode-block" id="getFFvalues"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.getFFvalues">[docs]</a><span class="k">def</span> <span class="nf">getFFvalues</span><span class="p">(</span><span class="n">FFtables</span><span class="p">,</span><span class="n">SQ</span><span class="p">,</span><span class="n">ifList</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="s">&#39;Needs a doc string&#39;</span>
    <span class="k">if</span> <span class="n">ifList</span><span class="p">:</span>
        <span class="n">FFvals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">FFtables</span><span class="p">:</span>
            <span class="n">FFvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ScatFac</span><span class="p">(</span><span class="n">FFtables</span><span class="p">[</span><span class="n">El</span><span class="p">],</span><span class="n">SQ</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">FFvals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">FFtables</span><span class="p">:</span>
            <span class="n">FFvals</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="n">ScatFac</span><span class="p">(</span><span class="n">FFtables</span><span class="p">[</span><span class="n">El</span><span class="p">],</span><span class="n">SQ</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">FFvals</span>
    </div>
<div class="viewcode-block" id="getBLvalues"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.getBLvalues">[docs]</a><span class="k">def</span> <span class="nf">getBLvalues</span><span class="p">(</span><span class="n">BLtables</span><span class="p">,</span><span class="n">ifList</span><span class="o">=</span><span class="bp">False</span><span class="p">):</span>
    <span class="s">&#39;Needs a doc string&#39;</span>
    <span class="k">if</span> <span class="n">ifList</span><span class="p">:</span>
        <span class="n">BLvals</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">BLtables</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;BW-LS&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">:</span>
                <span class="n">BLvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BLtables</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;BW-LS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BLvals</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">BLtables</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;SL&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">BLvals</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">El</span> <span class="ow">in</span> <span class="n">BLtables</span><span class="p">:</span>
            <span class="k">if</span> <span class="s">&#39;BW-LS&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">:</span>
                <span class="n">BLvals</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="n">BLtables</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;BW-LS&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">BLvals</span><span class="p">[</span><span class="n">El</span><span class="p">]</span> <span class="o">=</span> <span class="n">BLtables</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="mi">1</span><span class="p">][</span><span class="s">&#39;SL&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">BLvals</span>
        </div>
<div class="viewcode-block" id="GetFFC5"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetFFC5">[docs]</a><span class="k">def</span> <span class="nf">GetFFC5</span><span class="p">(</span><span class="n">ElSym</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Get 5 term form factor and Compton scattering data</span>

<span class="sd">    :param ElSym: str(1-2 character element symbol with proper case);</span>
<span class="sd">    :return El: dictionary with 5 term form factor &amp; compton coefficients</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span> <span class="nn">FormFactors</span> <span class="kn">as</span> <span class="nn">FF</span>
    <span class="n">El</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">FF5</span> <span class="o">=</span> <span class="n">FF</span><span class="o">.</span><span class="n">FFac5term</span><span class="p">[</span><span class="n">ElSym</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;fa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF5</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;fc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF5</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;fb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">FF5</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
    <span class="n">Cmp5</span> <span class="o">=</span> <span class="n">FF</span><span class="o">.</span><span class="n">Compton</span><span class="p">[</span><span class="n">ElSym</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cmp5</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cmp5</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Cmp5</span><span class="p">[</span><span class="mi">6</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">El</span>
    </div>
<div class="viewcode-block" id="CheckElement"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.CheckElement">[docs]</a><span class="k">def</span> <span class="nf">CheckElement</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Check if element El is in the periodic table</span>

<span class="sd">    :param str El: One or two letter element symbol, capitaliztion ignored</span>
<span class="sd">    :returns: True if the element is found</span>

<span class="sd">    &#39;&#39;&#39;</span>
    <span class="kn">import</span> <span class="nn">ElementTable</span> <span class="kn">as</span> <span class="nn">ET</span>
    <span class="n">Elements</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElTable</span><span class="p">:</span>
        <span class="n">Elements</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">El</span><span class="o">.</span><span class="n">capitalize</span><span class="p">()</span> <span class="ow">in</span> <span class="n">Elements</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">False</span> 
</div>
<div class="viewcode-block" id="FixValence"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.FixValence">[docs]</a><span class="k">def</span> <span class="nf">FixValence</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="s">&#39;Returns the element symbol, even when a valence is present&#39;</span>
    <span class="k">if</span> <span class="s">&#39;+&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span> <span class="c">#converts An+/- to A+/-n</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">El</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">El</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">num</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;+&#39;</span><span class="o">+</span><span class="n">num</span>
    <span class="k">if</span> <span class="s">&#39;+0&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">:</span>
        <span class="n">El</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;+0&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="s">&#39;-&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
        <span class="n">num</span> <span class="o">=</span> <span class="n">El</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">El</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">num</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">num</span>
    <span class="k">if</span> <span class="s">&#39;-0&#39;</span> <span class="ow">in</span> <span class="n">El</span><span class="p">:</span>
        <span class="n">El</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;-0&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">El</span>
    </div>
<div class="viewcode-block" id="GetAtomInfo"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetAtomInfo">[docs]</a><span class="k">def</span> <span class="nf">GetAtomInfo</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="s">&#39;reads element information from atmdata.py&#39;</span>
    <span class="kn">import</span> <span class="nn">ElementTable</span> <span class="kn">as</span> <span class="nn">ET</span>
    <span class="n">Elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">elem</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">elem</span> <span class="ow">in</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElTable</span><span class="p">]</span>
    <span class="n">AtomInfo</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">ElS</span> <span class="o">=</span> <span class="n">getElSym</span><span class="p">(</span><span class="n">El</span><span class="p">)</span>
    <span class="n">AtomInfo</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="s">&#39;Drad&#39;</span><span class="p">,</span><span class="s">&#39;Arad&#39;</span><span class="p">,</span><span class="s">&#39;Vdrad&#39;</span><span class="p">,</span><span class="s">&#39;Hbrad&#39;</span><span class="p">],</span><span class="n">atmdata</span><span class="o">.</span><span class="n">AtmSize</span><span class="p">[</span><span class="n">ElS</span><span class="p">])))</span>
    <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">El</span>
    <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Color&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ET</span><span class="o">.</span><span class="n">ElTable</span><span class="p">[</span><span class="n">Elements</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ElS</span><span class="p">)][</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">XrayFF</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="s">&#39;Z&#39;</span><span class="p">]</span>
    <span class="n">isotopes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ky</span> <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">AtmBlens</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">ElS</span> <span class="o">==</span> <span class="n">ky</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">isotopes</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Mass&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">AtmBlens</span><span class="p">[</span><span class="n">isotopes</span><span class="p">[</span><span class="mi">0</span><span class="p">]][</span><span class="s">&#39;Mass&#39;</span><span class="p">]</span>    <span class="c">#default to nat. abund.</span>
    <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Isotopes&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">isotope</span> <span class="ow">in</span> <span class="n">isotopes</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">AtmBlens</span><span class="p">[</span><span class="n">isotope</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">isotope</span> <span class="o">==</span> <span class="n">ElS</span><span class="o">+</span><span class="s">&#39;_&#39;</span><span class="p">:</span>
            <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Isotopes&#39;</span><span class="p">][</span><span class="s">&#39;Nat. Abund.&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">AtomInfo</span><span class="p">[</span><span class="s">&#39;Isotopes&#39;</span><span class="p">][</span><span class="n">isotope</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s">&#39;_&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">data</span>
    <span class="k">return</span> <span class="n">AtomInfo</span>
        </div>
<div class="viewcode-block" id="GetXsectionCoeff"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetXsectionCoeff">[docs]</a><span class="k">def</span> <span class="nf">GetXsectionCoeff</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read atom orbital scattering cross sections for fprime calculations via Cromer-Lieberman algorithm</span>

<span class="sd">    :param El: 2 character element symbol</span>
<span class="sd">    :return: Orbs: list of orbitals each a dictionary with detailed orbital information used by FPcalc</span>

<span class="sd">    each dictionary is:</span>

<span class="sd">    * &#39;OrbName&#39;: Orbital name read from file</span>
<span class="sd">    * &#39;IfBe&#39; 0/2 depending on orbital</span>
<span class="sd">    * &#39;BindEn&#39;: binding energy</span>
<span class="sd">    * &#39;BB&#39;: BindEn/0.02721</span>
<span class="sd">    * &#39;XSectIP&#39;: 5 cross section inflection points</span>
<span class="sd">    * &#39;ElEterm&#39;: energy correction term</span>
<span class="sd">    * &#39;SEdge&#39;: absorption edge for orbital</span>
<span class="sd">    * &#39;Nval&#39;: 10/11 depending on IfBe</span>
<span class="sd">    * &#39;LEner&#39;: 10/11 values of log(energy)</span>
<span class="sd">    * &#39;LXSect&#39;: 10/11 values of log(cross section)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">AU</span> <span class="o">=</span> <span class="mf">2.80022e+7</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">0.02721</span>
    <span class="n">ElS</span> <span class="o">=</span> <span class="n">El</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
    <span class="n">ElS</span> <span class="o">=</span> <span class="n">ElS</span><span class="o">.</span><span class="n">ljust</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">__file__</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="s">&#39;Xsect.dat&#39;</span><span class="p">)</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">xsec</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s">&#39;Ur&#39;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">print</span> <span class="s">&#39;**** ERROR - File Xsect.dat not found in directory </span><span class="si">%s</span><span class="s">&#39;</span> <span class="o">%</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="n">S</span> <span class="o">=</span> <span class="s">&#39;1&#39;</span>
    <span class="n">Orbs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">while</span> <span class="n">S</span><span class="p">:</span>
        <span class="n">S</span> <span class="o">=</span> <span class="n">xsec</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">S</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="n">ElS</span><span class="p">:</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">xsec</span><span class="o">.</span><span class="n">readline</span><span class="p">()[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">xsec</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>
            <span class="n">OrbName</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">9</span><span class="p">:</span><span class="mi">14</span><span class="p">]</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">14</span><span class="p">:]</span>
            <span class="n">IfBe</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">S</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">S</span> <span class="o">=</span> <span class="n">S</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">val</span> <span class="o">=</span> <span class="n">S</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
            <span class="n">BindEn</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">BB</span> <span class="o">=</span> <span class="n">BindEn</span><span class="o">/</span><span class="n">C1</span>
            <span class="n">Orb</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;OrbName&#39;</span><span class="p">:</span><span class="n">OrbName</span><span class="p">,</span><span class="s">&#39;IfBe&#39;</span><span class="p">:</span><span class="n">IfBe</span><span class="p">,</span><span class="s">&#39;BindEn&#39;</span><span class="p">:</span><span class="n">BindEn</span><span class="p">,</span><span class="s">&#39;BB&#39;</span><span class="p">:</span><span class="n">BB</span><span class="p">}</span>
            <span class="n">Energy</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">XSect</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">11</span><span class="p">):</span>
                <span class="n">Energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]))</span>
                <span class="n">XSect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">2</span><span class="o">*</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]))</span>
            <span class="n">XSecIP</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span> <span class="n">XSecIP</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">XSect</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">AU</span><span class="p">)</span>
            <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;XSecIP&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">XSecIP</span>
            <span class="k">if</span> <span class="n">IfBe</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;SEdge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">XSect</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">/</span><span class="n">AU</span>
                <span class="n">Nval</span> <span class="o">=</span> <span class="mi">11</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;ElEterm&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">XSect</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">Energy</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
                <span class="k">del</span> <span class="n">XSect</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>
                <span class="n">Nval</span> <span class="o">=</span> <span class="mi">10</span>
                <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;SEdge&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;Nval&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Nval</span>
            <span class="n">D</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">Energy</span><span class="p">,</span><span class="n">XSect</span><span class="p">))</span>
            <span class="n">Energy</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
            <span class="n">X</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">Energy</span><span class="p">:</span>
                <span class="n">X</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">D</span><span class="p">[</span><span class="n">key</span><span class="p">])</span>
            <span class="n">XSect</span> <span class="o">=</span> <span class="n">X</span>
            <span class="n">LEner</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">LXSect</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nval</span><span class="p">):</span>
                <span class="n">LEner</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Energy</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">if</span> <span class="n">XSect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mf">0.0</span><span class="p">:</span>
                    <span class="n">LXSect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">XSect</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">LXSect</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;LEner&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LEner</span>
            <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;LXSect&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">LXSect</span>
            <span class="n">Orbs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">Orb</span><span class="p">)</span>
    <span class="n">xsec</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">Orbs</span>
    </div>
<div class="viewcode-block" id="GetMagFormFacCoeff"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.GetMagFormFacCoeff">[docs]</a><span class="k">def</span> <span class="nf">GetMagFormFacCoeff</span><span class="p">(</span><span class="n">El</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Read magnetic form factor data from atomdata.asc file</span>

<span class="sd">    :param El: 2 character element symbol</span>
<span class="sd">    :return: MagFormFactors: list of all magnetic form factors dictionaries for element El.</span>

<span class="sd">    each dictionary contains:</span>

<span class="sd">    * &#39;Symbol&#39;:Symbol</span>
<span class="sd">    * &#39;Z&#39;:Z</span>
<span class="sd">    * &#39;mfa&#39;: 4 MA coefficients</span>
<span class="sd">    * &#39;nfa&#39;: 4 NA coefficients</span>
<span class="sd">    * &#39;mfb&#39;: 4 MB coefficients</span>
<span class="sd">    * &#39;nfb&#39;: 4 NB coefficients</span>
<span class="sd">    * &#39;mfc&#39;: MC coefficient</span>
<span class="sd">    * &#39;nfc&#39;: NC coefficient</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MagFormFactors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">mags</span> <span class="o">=</span> <span class="p">[</span><span class="n">ky</span> <span class="k">for</span> <span class="n">ky</span> <span class="ow">in</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">MagFF</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">El</span> <span class="o">==</span> <span class="n">getElSym</span><span class="p">(</span><span class="n">ky</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">mag</span> <span class="ow">in</span> <span class="n">mags</span><span class="p">:</span>
        <span class="n">magData</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">MagFF</span><span class="p">[</span><span class="n">mag</span><span class="p">]</span>
        <span class="n">magData</span><span class="p">[</span><span class="s">&#39;Symbol&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mag</span>
        <span class="n">magData</span><span class="p">[</span><span class="s">&#39;Z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">atmdata</span><span class="o">.</span><span class="n">XrayFF</span><span class="p">[</span><span class="n">getElSym</span><span class="p">(</span><span class="n">mags</span><span class="p">)][</span><span class="s">&#39;Z&#39;</span><span class="p">]</span>
        <span class="n">magData</span><span class="p">[</span><span class="s">&#39;mfa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;M&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
        <span class="n">magdata</span><span class="p">[</span><span class="s">&#39;mfb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;M&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
        <span class="n">magdata</span><span class="p">[</span><span class="s">&#39;mfc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;M&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">magData</span><span class="p">[</span><span class="s">&#39;nfa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
        <span class="n">magdata</span><span class="p">[</span><span class="s">&#39;nfb&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">data</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]]</span>
        <span class="n">magdata</span><span class="p">[</span><span class="s">&#39;nfc&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">][</span><span class="mi">8</span><span class="p">]</span>
        <span class="n">magdata</span><span class="p">[</span><span class="s">&#39;g-fac&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s">&#39;N&#39;</span><span class="p">][</span><span class="mi">9</span><span class="p">]</span>
        <span class="n">MagFormFactors</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">magdata</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">MagFormFactors</span>
</div>
<div class="viewcode-block" id="ScatFac"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.ScatFac">[docs]</a><span class="k">def</span> <span class="nf">ScatFac</span><span class="p">(</span><span class="n">El</span><span class="p">,</span> <span class="n">SQ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;compute value of form factor</span>

<span class="sd">    :param El: element dictionary defined in GetFormFactorCoeff </span>
<span class="sd">    :param SQ: (sin-theta/lambda)**2</span>
<span class="sd">    :return: real part of form factor</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">fa</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">El</span><span class="p">[</span><span class="s">&#39;fa&#39;</span><span class="p">])</span>
    <span class="n">fb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">El</span><span class="p">[</span><span class="s">&#39;fb&#39;</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="n">fb</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">SQ</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">fa</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">)[:],</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">+</span><span class="n">El</span><span class="p">[</span><span class="s">&#39;fc&#39;</span><span class="p">]</span>
        </div>
<span class="k">def</span> <span class="nf">BlenResCW</span><span class="p">(</span><span class="n">Els</span><span class="p">,</span><span class="n">BLtables</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
    <span class="n">FP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Els</span><span class="p">))</span>
    <span class="n">FPP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Els</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">El</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Els</span><span class="p">):</span>
        <span class="n">BL</span> <span class="o">=</span> <span class="n">BLtables</span><span class="p">[</span><span class="n">El</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">if</span> <span class="s">&#39;BW-LS&#39;</span> <span class="ow">in</span> <span class="n">BL</span><span class="p">:</span>
            <span class="n">Re</span><span class="p">,</span><span class="n">Im</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">gam</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">E2</span> <span class="o">=</span> <span class="n">BL</span><span class="p">[</span><span class="s">&#39;BW-LS&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">Emev</span> <span class="o">=</span> <span class="mf">81.80703</span><span class="o">/</span><span class="n">wave</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">T0</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E0</span>
            <span class="n">T1</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E1</span>
            <span class="n">T2</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E2</span>
            <span class="n">D0</span> <span class="o">=</span> <span class="n">T0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">D1</span> <span class="o">=</span> <span class="n">T1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">D2</span> <span class="o">=</span> <span class="n">T2</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">FP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Re</span><span class="o">*</span><span class="p">(</span><span class="n">T0</span><span class="o">/</span><span class="n">D0</span><span class="o">+</span><span class="n">A</span><span class="o">*</span><span class="n">T1</span><span class="o">/</span><span class="n">D1</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">T2</span><span class="o">/</span><span class="n">D2</span><span class="p">)</span>
            <span class="n">FPP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Im</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">D0</span><span class="o">+</span><span class="n">A</span><span class="o">/</span><span class="n">D1</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">D2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">FPP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">BL</span><span class="p">[</span><span class="s">&#39;SL&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>    <span class="c">#for Li, B, etc.</span>
    <span class="k">return</span> <span class="n">FP</span><span class="p">,</span><span class="n">FPP</span>
    
<span class="k">def</span> <span class="nf">BlenResTOF</span><span class="p">(</span><span class="n">Els</span><span class="p">,</span><span class="n">BLtables</span><span class="p">,</span><span class="n">wave</span><span class="p">):</span>
    <span class="n">FP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Els</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)))</span>
    <span class="n">FPP</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">Els</span><span class="p">),</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">)))</span>
    <span class="n">BL</span> <span class="o">=</span> <span class="p">[</span><span class="n">BLtables</span><span class="p">[</span><span class="n">el</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="n">Els</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">El</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">Els</span><span class="p">):</span>
        <span class="k">if</span> <span class="s">&#39;BW-LS&#39;</span> <span class="ow">in</span> <span class="n">BL</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
            <span class="n">Re</span><span class="p">,</span><span class="n">Im</span><span class="p">,</span><span class="n">E0</span><span class="p">,</span><span class="n">gam</span><span class="p">,</span><span class="n">A</span><span class="p">,</span><span class="n">E1</span><span class="p">,</span><span class="n">B</span><span class="p">,</span><span class="n">E2</span> <span class="o">=</span> <span class="n">BL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;BW-LS&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">:]</span>
            <span class="n">Emev</span> <span class="o">=</span> <span class="mf">81.80703</span><span class="o">/</span><span class="n">wave</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">T0</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E0</span>
            <span class="n">T1</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E1</span>
            <span class="n">T2</span> <span class="o">=</span> <span class="n">Emev</span><span class="o">-</span><span class="n">E2</span>
            <span class="n">D0</span> <span class="o">=</span> <span class="n">T0</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">D1</span> <span class="o">=</span> <span class="n">T1</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">D2</span> <span class="o">=</span> <span class="n">T2</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">gam</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">FP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Re</span><span class="o">*</span><span class="p">(</span><span class="n">T0</span><span class="o">/</span><span class="n">D0</span><span class="o">+</span><span class="n">A</span><span class="o">*</span><span class="n">T1</span><span class="o">/</span><span class="n">D1</span><span class="o">+</span><span class="n">B</span><span class="o">*</span><span class="n">T2</span><span class="o">/</span><span class="n">D2</span><span class="p">)</span>
            <span class="n">FPP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">Im</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">D0</span><span class="o">+</span><span class="n">A</span><span class="o">/</span><span class="n">D1</span><span class="o">+</span><span class="n">B</span><span class="o">/</span><span class="n">D2</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">FPP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span><span class="o">*</span><span class="n">BL</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s">&#39;SL&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>    <span class="c">#for Li, B, etc.</span>
    <span class="k">return</span> <span class="n">FP</span><span class="p">,</span><span class="n">FPP</span>
    
<div class="viewcode-block" id="ComptonFac"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.ComptonFac">[docs]</a><span class="k">def</span> <span class="nf">ComptonFac</span><span class="p">(</span><span class="n">El</span><span class="p">,</span><span class="n">SQ</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;compute Compton scattering factor</span>

<span class="sd">    :param El: element dictionary </span>
<span class="sd">    :param SQ: (sin-theta/lambda)**2</span>
<span class="sd">    :return: compton scattering factor</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">ca</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpa&#39;</span><span class="p">])</span>
    <span class="n">cb</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpb&#39;</span><span class="p">])</span>
    <span class="n">t</span> <span class="o">=</span> <span class="o">-</span><span class="n">cb</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">SQ</span>       
    <span class="k">return</span> <span class="n">El</span><span class="p">[</span><span class="s">&#39;cmpz&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">ca</span><span class="p">[:,</span><span class="n">np</span><span class="o">.</span><span class="n">newaxis</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">t</span><span class="p">),</span><span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> 
            </div>
<div class="viewcode-block" id="FPcalc"><a class="viewcode-back" href="../GSASIIutil.html#GSASIIElem.FPcalc">[docs]</a><span class="k">def</span> <span class="nf">FPcalc</span><span class="p">(</span><span class="n">Orbs</span><span class="p">,</span> <span class="n">KEv</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Compute real &amp; imaginary resonant X-ray scattering factors</span>

<span class="sd">    :param Orbs: list of orbital dictionaries as defined in GetXsectionCoeff</span>
<span class="sd">    :param KEv: x-ray energy in keV</span>
<span class="sd">    :return: C: (f&#39;,f&quot;,mu): real, imaginary parts of resonant scattering &amp; atomic absorption coeff.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="nf">Aitken</span><span class="p">(</span><span class="n">Orb</span><span class="p">,</span> <span class="n">LKev</span><span class="p">):</span>
        <span class="n">Nval</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;Nval&#39;</span><span class="p">]</span>
        <span class="n">j</span> <span class="o">=</span> <span class="n">Nval</span><span class="o">-</span><span class="mi">1</span>
        <span class="n">LEner</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;LEner&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Nval</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">LEner</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">LKev</span><span class="p">:</span> <span class="n">j</span> <span class="o">=</span> <span class="n">i</span>
        <span class="k">if</span> <span class="n">j</span> <span class="o">&gt;</span> <span class="n">Nval</span><span class="o">-</span><span class="mi">3</span><span class="p">:</span> <span class="n">j</span><span class="o">=</span> <span class="n">Nval</span><span class="o">-</span><span class="mi">3</span>
        <span class="n">T</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">LXSect</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;LXSect&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">LXSect</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="n">LEner</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">j</span><span class="p">]</span><span class="o">-</span><span class="n">LKev</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">-</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="p">])</span>
        <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">-</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span><span class="o">/</span><span class="p">(</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span><span class="o">-</span><span class="n">LEner</span><span class="p">[</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">C</span> <span class="o">=</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">C</span>
    
    <span class="k">def</span> <span class="nf">DGauss</span><span class="p">(</span><span class="n">Orb</span><span class="p">,</span><span class="n">CX</span><span class="p">,</span><span class="n">RX</span><span class="p">,</span><span class="n">ISig</span><span class="p">):</span>
        <span class="n">ALG</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.11846344252810</span><span class="p">,</span><span class="mf">0.23931433524968</span><span class="p">,</span><span class="mf">0.284444444444</span><span class="p">,</span>
        <span class="mf">0.23931433524968</span><span class="p">,</span><span class="mf">0.11846344252810</span><span class="p">)</span>
        <span class="n">XLG</span> <span class="o">=</span> <span class="p">(</span><span class="mf">0.04691007703067</span><span class="p">,</span><span class="mf">0.23076534494716</span><span class="p">,</span><span class="mf">0.5</span><span class="p">,</span>
        <span class="mf">0.76923465505284</span><span class="p">,</span><span class="mf">0.95308992296933</span><span class="p">)</span>
        
        <span class="n">D</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="n">B2</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;BB&#39;</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">R2</span> <span class="o">=</span> <span class="n">RX</span><span class="o">**</span><span class="mi">2</span>
        <span class="n">XSecIP</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;XSecIP&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
            <span class="n">X</span> <span class="o">=</span> <span class="n">XLG</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">X2</span> <span class="o">=</span> <span class="n">X</span><span class="o">**</span><span class="mi">2</span>
            <span class="n">XS</span> <span class="o">=</span> <span class="n">XSecIP</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">ISig</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">BB</span><span class="o">*</span><span class="p">(</span><span class="n">XS</span><span class="o">*</span><span class="p">(</span><span class="n">B2</span><span class="o">/</span><span class="n">X2</span><span class="p">)</span><span class="o">-</span><span class="n">CX</span><span class="o">*</span><span class="n">R2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">R2</span><span class="o">*</span><span class="n">X2</span><span class="o">-</span><span class="n">B2</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">ISig</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">S</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">BB</span><span class="o">*</span><span class="n">B2</span><span class="o">*</span><span class="n">XS</span><span class="o">/</span><span class="p">(</span><span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">X</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">R2</span><span class="o">*</span><span class="n">X2</span><span class="o">-</span><span class="n">X</span><span class="o">*</span><span class="n">B2</span><span class="p">))</span>
            <span class="k">elif</span> <span class="n">ISig</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
                <span class="n">T</span> <span class="o">=</span> <span class="n">X</span><span class="o">*</span><span class="n">X2</span><span class="o">*</span><span class="n">R2</span><span class="o">-</span><span class="n">B2</span><span class="o">/</span><span class="n">X</span>
                <span class="n">S</span> <span class="o">=</span> <span class="mf">2.0</span><span class="o">*</span><span class="n">BB</span><span class="o">*</span><span class="p">(</span><span class="n">XS</span><span class="o">*</span><span class="n">B2</span><span class="o">/</span><span class="p">(</span><span class="n">T</span><span class="o">*</span><span class="n">X2</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">CX</span><span class="o">*</span><span class="n">R2</span><span class="o">/</span><span class="n">T</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">S</span> <span class="o">=</span> <span class="n">BB</span><span class="o">*</span><span class="n">B2</span><span class="o">*</span><span class="p">(</span><span class="n">XS</span><span class="o">-</span><span class="n">Orb</span><span class="p">[</span><span class="s">&#39;SEdge&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">X2</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">R2</span><span class="o">*</span><span class="n">X2</span><span class="o">**</span><span class="mi">2</span><span class="o">-</span><span class="n">X2</span><span class="o">*</span><span class="n">B2</span><span class="p">)</span>
            <span class="n">A</span> <span class="o">=</span> <span class="n">ALG</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">D</span> <span class="o">+=</span> <span class="n">A</span><span class="o">*</span><span class="n">S</span>
        <span class="k">return</span> <span class="n">D</span> 
    
    <span class="n">AU</span> <span class="o">=</span> <span class="mf">2.80022e+7</span>
    <span class="n">C1</span> <span class="o">=</span> <span class="mf">0.02721</span>
    <span class="n">C</span> <span class="o">=</span> <span class="mf">137.0367</span>
    <span class="n">FP</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">FPP</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">Mu</span> <span class="o">=</span> <span class="mf">0.0</span>
    <span class="n">LKev</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">KEv</span><span class="p">)</span>
    <span class="n">RX</span> <span class="o">=</span> <span class="n">KEv</span><span class="o">/</span><span class="n">C1</span>
    <span class="k">if</span> <span class="n">Orbs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">Orb</span> <span class="ow">in</span> <span class="n">Orbs</span><span class="p">:</span>
            <span class="n">CX</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">BB</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;BB&#39;</span><span class="p">]</span>
            <span class="n">BindEn</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;BindEn&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;IfBe&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span> <span class="n">ElEterm</span> <span class="o">=</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;ElEterm&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">BindEn</span> <span class="o">&lt;=</span> <span class="n">KEv</span><span class="p">:</span>
                <span class="n">CX</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">Aitken</span><span class="p">(</span><span class="n">Orb</span><span class="p">,</span><span class="n">LKev</span><span class="p">))</span>
                <span class="n">Mu</span> <span class="o">+=</span> <span class="n">CX</span>
                <span class="n">CX</span> <span class="o">/=</span> <span class="n">AU</span>
            <span class="n">Corr</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">if</span> <span class="n">Orb</span><span class="p">[</span><span class="s">&#39;IfBe&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">BindEn</span> <span class="o">&gt;=</span> <span class="n">KEv</span><span class="p">:</span>
                <span class="n">CX</span> <span class="o">=</span> <span class="mf">0.0</span>
                <span class="n">FPI</span> <span class="o">=</span> <span class="n">DGauss</span><span class="p">(</span><span class="n">Orb</span><span class="p">,</span><span class="n">CX</span><span class="p">,</span><span class="n">RX</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
                <span class="n">Corr</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">Orb</span><span class="p">[</span><span class="s">&#39;SEdge&#39;</span><span class="p">]</span><span class="o">*</span><span class="n">BB</span><span class="o">**</span><span class="mi">2</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">RX</span><span class="o">-</span><span class="n">BB</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="o">-</span><span class="n">RX</span><span class="o">-</span><span class="n">BB</span><span class="p">))</span><span class="o">/</span><span class="n">RX</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">FPI</span> <span class="o">=</span> <span class="n">DGauss</span><span class="p">(</span><span class="n">Orb</span><span class="p">,</span><span class="n">CX</span><span class="p">,</span><span class="n">RX</span><span class="p">,</span><span class="n">Orb</span><span class="p">[</span><span class="s">&#39;IfBe&#39;</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">CX</span> <span class="o">!=</span> <span class="mf">0.0</span><span class="p">:</span> <span class="n">Corr</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.5</span><span class="o">*</span><span class="n">CX</span><span class="o">*</span><span class="n">RX</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">log</span><span class="p">((</span><span class="n">RX</span><span class="o">+</span><span class="n">BB</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">RX</span><span class="o">-</span><span class="n">BB</span><span class="p">))</span>
            <span class="n">FPI</span> <span class="o">=</span> <span class="p">(</span><span class="n">FPI</span><span class="o">+</span><span class="n">Corr</span><span class="p">)</span><span class="o">*</span><span class="n">C</span><span class="o">/</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="n">FPPI</span> <span class="o">=</span> <span class="n">C</span><span class="o">*</span><span class="n">CX</span><span class="o">*</span><span class="n">RX</span><span class="o">/</span><span class="p">(</span><span class="mf">4.0</span><span class="o">*</span><span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
            <span class="n">FP</span> <span class="o">+=</span> <span class="n">FPI</span>
            <span class="n">FPP</span> <span class="o">+=</span> <span class="n">FPPI</span>
        <span class="n">FP</span> <span class="o">-=</span> <span class="n">ElEterm</span>
    
    <span class="k">return</span> <span class="p">(</span><span class="n">FP</span><span class="p">,</span> <span class="n">FPP</span><span class="p">,</span> <span class="n">Mu</span><span class="p">)</span>
    
</pre></div></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/G2_html_logo.png" alt="Logo"/>
            </a></p>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li><a href="../index.html">GSAS-II 0.2.0 documentation</a> &raquo;</li>
          <li><a href="index.html" >Module code</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2013, Von Dreele and Toby for Argonne National Laboratory.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>